<?xml version="1.0" encoding="utf-8"?>
<search> 
  
    
    <entry>
      <title><![CDATA[iOS中代理使用]]></title>
      <url>/2018/03/01/iOS%E4%B8%AD%E4%BB%A3%E7%90%86%E4%BD%BF%E7%94%A8/</url>
      <content type="html"><![CDATA[<ul>
<li>定义一份代理协议<ul>
<li>协议名称的格式一般是：类名＋Delegate<ul>
<li>比如UITableViewDelegate</li>
</ul>
</li>
<li>设计代理的细节<ul>
<li>一般都是@optional(让代理可以有选择的实现一些代理方法)</li>
<li>方法名一般都以类名开头<ul>
<li>比如<code>- (void)scrollViewDidScroll:</code></li>
</ul>
</li>
<li>一般都需要将对象本身传出去<ul>
<li>比如tableview的代理方法都会把tableview本身传出去</li>
</ul>
</li>
</ul>
</li>
<li>必须要遵守NSObject协议(基协议)<ul>
<li>比如<code>@protocol CellDelegate &lt;NSObject&gt;</code></li>
</ul>
</li>
</ul>
</li>
<li>声明一个代理属性<ul>
<li>代理的类型格式:id &lt;协议&gt; delegate</li>
</ul>
</li>
</ul>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>,<span class="keyword">weak</span>) <span class="keyword">id</span>&lt;CellDelegate&gt; delegate;</span><br></pre></td></tr></table></figure>
<ul>
<li>设置代理对象</li>
<li>代理对象遵守协议，实现协议里面相应的方法</li>
<li>当控件内部发生一些事情，就可以调用代理的代理方法通知代理<ul>
<li>如果代理方法是@optional,那么需要判断方法是否有实现，直接调用可能会报错</li>
</ul>
</li>
</ul>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> ([<span class="keyword">self</span>.delegate respondsToSelector:<span class="keyword">@selector</span>(wineCellDidClickPlusButton:)]) &#123;</span><br><span class="line">    [<span class="keyword">self</span>.delegate wineCellDidClickPlusButton:<span class="keyword">self</span>];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
]]></content>
      
        <categories>
            
            <category> iOS开发 </category>
            
        </categories>
        
        
        <tags>
            
            <tag> iOS </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[iOS中的通知NSNotificationCenter]]></title>
      <url>/2018/03/01/iOS%E4%B8%AD%E7%9A%84%E9%80%9A%E7%9F%A5NSNotificationCenter/</url>
      <content type="html"><![CDATA[<ol>
<li>通知中心(NSNotificationCenter)是在程序内部提供的一种广播机制。把接收到的消息，根据内部的消息转发表，将消息转发给需要的对象。</li>
<li><p>通知使用分为两步，第一步：在需要使用的地方注册要观察的通知，第二部：在某地方发送通知。(发送的通知可以是我们自定义的通知，也可以是系统的通知)</p>
<pre><code>如下demo
</code></pre><p> <code>Person.h</code></p>
</li>
</ol>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">//  Person.h</span></span><br><span class="line"><span class="comment">//  通知-demo</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">//  Created by 武 on 18/2/28.</span></span><br><span class="line"><span class="comment">//  Copyright © 2018年 com. All rights reserved.</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#import <span class="meta-string">&lt;Foundation/Foundation.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">@interface</span> <span class="title">Person</span> : <span class="title">NSObject</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>,<span class="keyword">copy</span>) <span class="built_in">NSString</span> *name;</span><br><span class="line"></span><br><span class="line"><span class="keyword">@end</span></span><br></pre></td></tr></table></figure>
<p>​    <code>Person.m</code></p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">//  Person.m</span></span><br><span class="line"><span class="comment">//  通知-demo</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">//  Created by 武 on 18/2/28.</span></span><br><span class="line"><span class="comment">//  Copyright © 2018年 com. All rights reserved.</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#import <span class="meta-string">"Person.h"</span></span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">@implementation</span> <span class="title">Person</span></span></span><br><span class="line"></span><br><span class="line">-(<span class="keyword">void</span>)getNew:(<span class="built_in">NSNotification</span> *)note</span><br><span class="line">&#123;</span><br><span class="line">    <span class="built_in">NSLog</span>(<span class="string">@"%@接收到了%@发布的%@通知,通知内容是%@"</span>,<span class="keyword">self</span>.name,[note.object name],note.name,note.userInfo);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">@end</span></span><br></pre></td></tr></table></figure>
<p><code>Company.h</code></p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">//  Company.h</span></span><br><span class="line"><span class="comment">//  通知-demo</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">//  Created by 武 on 18/2/28.</span></span><br><span class="line"><span class="comment">//  Copyright © 2018年 com. All rights reserved.</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#import <span class="meta-string">&lt;Foundation/Foundation.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">@interface</span> <span class="title">Company</span> : <span class="title">NSObject</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>,<span class="keyword">copy</span>) <span class="built_in">NSString</span> *name;</span><br><span class="line"></span><br><span class="line"><span class="keyword">@end</span></span><br></pre></td></tr></table></figure>
<p><code>Company.m</code></p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">//  Company.m</span></span><br><span class="line"><span class="comment">//  通知-demo</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">//  Created by 武 on 18/2/28.</span></span><br><span class="line"><span class="comment">//  Copyright © 2018年 com. All rights reserved.</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#import <span class="meta-string">"Company.h"</span></span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">@implementation</span> <span class="title">Company</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">@end</span></span><br></pre></td></tr></table></figure>
<p><code>ViewController.m</code></p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">//  ViewController.m</span></span><br><span class="line"><span class="comment">//  通知-demo</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">//  Created by 武 on 18/2/28.</span></span><br><span class="line"><span class="comment">//  Copyright © 2018年 com. All rights reserved.</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#import <span class="meta-string">"ViewController.h"</span></span></span><br><span class="line"><span class="meta">#import <span class="meta-string">"Person.h"</span></span></span><br><span class="line"><span class="meta">#import <span class="meta-string">"Company.h"</span></span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">@interface</span> <span class="title">ViewController</span> ()</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">@end</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">@implementation</span> <span class="title">ViewController</span></span></span><br><span class="line"></span><br><span class="line">- (<span class="keyword">void</span>)viewDidLoad &#123;</span><br><span class="line">    [<span class="keyword">super</span> viewDidLoad];</span><br><span class="line">    </span><br><span class="line">    Company *com1 = [[Company alloc]init];</span><br><span class="line">    com1.name = <span class="string">@"Tencent"</span>;</span><br><span class="line">    </span><br><span class="line">    Company *com2 = [[Company alloc]init];</span><br><span class="line">    com2.name = <span class="string">@"Sina"</span>;</span><br><span class="line">    </span><br><span class="line">    Person *p1 = [[Person alloc]init];</span><br><span class="line">    p1.name = <span class="string">@"张三"</span>;</span><br><span class="line">    Person *p2 = [[Person alloc]init];</span><br><span class="line">    p2.name = <span class="string">@"李四"</span>;</span><br><span class="line">    Person *p3 = [[Person alloc]init];</span><br><span class="line">    p3.name = <span class="string">@"王五"</span>;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">/***模拟通知**/</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">//监听通知</span></span><br><span class="line">    [[<span class="built_in">NSNotificationCenter</span> defaultCenter] addObserver:p1 selector:<span class="keyword">@selector</span>(getNew:) name:<span class="literal">nil</span> object:<span class="literal">nil</span>];</span><br><span class="line">    </span><br><span class="line">    <span class="comment">//发布通知</span></span><br><span class="line">    <span class="built_in">NSNotification</span> *note = [<span class="built_in">NSNotification</span> notificationWithName:<span class="string">@"军事新闻"</span> object:com1 userInfo:@&#123;<span class="string">@"title"</span>:<span class="string">@"xxxxxxx"</span>&#125;];</span><br><span class="line">    [[<span class="built_in">NSNotificationCenter</span> defaultCenter] postNotification:note];</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">    <span class="comment">//移除通知</span></span><br><span class="line">    [[<span class="built_in">NSNotificationCenter</span> defaultCenter]removeObserver:p1];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">@end</span></span><br></pre></td></tr></table></figure>
<p><code>首先p1张三注册监听，它监听的通知name和object为nil说明它可以监听任何对象发布的任意通知,然后com1发布了一条名称为军事新闻内容为xxxxxxx的通知，张三一旦监听到这条通知就会执行getNew这个方法，这个方法携带了通知的发布者，通知的名称通知的内容等信息。</code></p>
]]></content>
      
        <categories>
            
            <category> iOS开发 </category>
            
        </categories>
        
        
        <tags>
            
            <tag> iOS </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[UITableView]]></title>
      <url>/2018/01/29/UITableView/</url>
      <content type="html"><![CDATA[<h4 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h4><p>从字面可以看出它是一个表格UI控件，在iOS开发中UITableView可以说是使用最广泛的控件，我们在使用软件中到处可以看到它的影子，例如QQ以及微信的联系人界面都是UITableView.</p>
<p>UITableView有两种显示风格，一个是分组样式，一个是不分组样式。如下图</p>
<p>不分组样式</p>
<p><img src="/2018/01/29/UITableView/1.png" alt="不分组样式">    </p>
<p>分组样式</p>
<p><img src="/2018/01/29/UITableView/2.png" alt="分组样式"> </p>
<p>可以看到在UITableView中数据只有行的概念，并没有列的概念，因为在手机操作中显示列是不利于操作的。</p>
<p><code>UITableView中每行数据都是一个UITableViewCell</code>在这个控件中为了显示更多的信息，iOS已经在其内部设置了多个子控件供使用。一个contentView座位其他元素的父控件，两个UILabel控件（textLabel,detailTextLabel）,一个imageView，分别用于容器、显示内容、详情和图片。</p>
<p>这些控件不一定要全部使用，具体操作时可以通过UITableViewCellStyle进行设置，它是一个枚举表示UITableView的排列方式。</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">typedef</span> <span class="built_in">NS_ENUM</span>(<span class="built_in">NSInteger</span>, <span class="built_in">UITableViewCellStyle</span>) &#123;</span><br><span class="line">    <span class="built_in">UITableViewCellStyleDefault</span>,    <span class="comment">// 左侧显示textLabel（不显示detailTextLabel），imageView可选（显示在最左边）</span></span><br><span class="line">    <span class="built_in">UITableViewCellStyleValue1</span>,        <span class="comment">// 左侧显示textLabel、右侧显示detailTextLabel（默认蓝色），imageView可选（显示在最左边）</span></span><br><span class="line">    <span class="built_in">UITableViewCellStyleValue2</span>,        <span class="comment">// 左侧依次显示textLabel(默认蓝色)和detailTextLabel，imageView可选（显示在最左边）</span></span><br><span class="line">    <span class="built_in">UITableViewCellStyleSubtitle</span>    <span class="comment">// 左上方显示textLabel，左下方显示detailTextLabel（默认灰色）,imageView可选（显示在最左边）</span></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h4 id="数据源"><a href="#数据源" class="headerlink" title="数据源"></a>数据源</h4><p>由于iOS是遵循MVC模式设计的，很多操作都是通过代理和外界沟通的，但对于数据源控件除了代理还有一个数据源属性，通过它和外界进行数据交互。 对于UITableView设置完dataSource后需要实现UITableViewDataSource协议，在这个协议中定义了多种 数据操作方法。</p>
<p>简单示例</p>
<p>新建一个person模型类</p>
<p><code>person.h</code></p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">//  Person.h</span></span><br><span class="line"><span class="comment">//  UITableView简单示例</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">//  Created by 武 on 18/1/29.</span></span><br><span class="line"><span class="comment">//  Copyright © 2018年 com. All rights reserved.</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#import <span class="meta-string">&lt;Foundation/Foundation.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">@interface</span> <span class="title">Person</span> : <span class="title">NSObject</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>,<span class="keyword">copy</span>) <span class="built_in">NSString</span> *firstName;</span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>,<span class="keyword">copy</span>) <span class="built_in">NSString</span> *lastName;</span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>,<span class="keyword">copy</span>) <span class="built_in">NSString</span> *phoneNumber;</span><br><span class="line"></span><br><span class="line">- (Person *)initWithFirstName:(<span class="built_in">NSString</span> *)firstName andLastName:(<span class="built_in">NSString</span> *)lastName andPhoneNumber:(<span class="built_in">NSString</span> *)phoneNumber;</span><br><span class="line"></span><br><span class="line">- (<span class="built_in">NSString</span> *)getName;</span><br><span class="line"></span><br><span class="line">+ (Person *)initWithFirstName:(<span class="built_in">NSString</span> *)firstName andLastName:(<span class="built_in">NSString</span> *)lastName andPhoneNumber:(<span class="built_in">NSString</span> *)phoneNumber;</span><br><span class="line"><span class="keyword">@end</span></span><br></pre></td></tr></table></figure>
<p><code>person.m</code></p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">//  Person.m</span></span><br><span class="line"><span class="comment">//  UITableView简单示例</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">//  Created by 武 on 18/1/29.</span></span><br><span class="line"><span class="comment">//  Copyright © 2018年 com. All rights reserved.</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#import <span class="meta-string">"Person.h"</span></span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">@implementation</span> <span class="title">Person</span></span></span><br><span class="line"></span><br><span class="line">-(Person *)initWithFirstName:(<span class="built_in">NSString</span> *)firstName andLastName:(<span class="built_in">NSString</span> *)lastName andPhoneNumber:(<span class="built_in">NSString</span> *)phoneNumber</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">self</span>=[<span class="keyword">super</span> init]) &#123;</span><br><span class="line">        <span class="keyword">self</span>.firstName = firstName;</span><br><span class="line">        <span class="keyword">self</span>.lastName = lastName;</span><br><span class="line">        <span class="keyword">self</span>.phoneNumber = phoneNumber;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">self</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">-(<span class="built_in">NSString</span> *)getName</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">return</span> [<span class="built_in">NSString</span> stringWithFormat:<span class="string">@"%@-%@"</span>,_lastName,_firstName];</span><br><span class="line">&#125;</span><br><span class="line">+(Person *)initWithFirstName:(<span class="built_in">NSString</span> *)firstName andLastName:(<span class="built_in">NSString</span> *)lastName andPhoneNumber:(<span class="built_in">NSString</span> *)phoneNumber</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">return</span> [[<span class="keyword">self</span> alloc]initWithFirstName:firstName andLastName:lastName andPhoneNumber:phoneNumber];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">@end</span></span><br></pre></td></tr></table></figure>
<p>新建PersonGroup模型类</p>
<p><code>PersonGroup.h</code></p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">//  PersonGroup.h</span></span><br><span class="line"><span class="comment">//  UITableView简单示例</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">//  Created by 武 on 18/1/29.</span></span><br><span class="line"><span class="comment">//  Copyright © 2018年 com. All rights reserved.</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#import <span class="meta-string">&lt;Foundation/Foundation.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">@interface</span> <span class="title">PersonGroup</span> : <span class="title">NSObject</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>,<span class="keyword">copy</span>) <span class="built_in">NSString</span> *name;</span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>,<span class="keyword">copy</span>) <span class="built_in">NSString</span> *detail;</span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>,<span class="keyword">strong</span>) <span class="built_in">NSMutableArray</span> *persons;</span><br><span class="line"></span><br><span class="line">-(PersonGroup *)initWithName:(<span class="built_in">NSString</span> *)name andDetail:(<span class="built_in">NSString</span> *)detail andPerson:(<span class="built_in">NSMutableArray</span> *)persons;</span><br><span class="line"></span><br><span class="line">+(PersonGroup *)initWithName:(<span class="built_in">NSString</span> *)name andDetail:(<span class="built_in">NSString</span> *)detail andPerson:(<span class="built_in">NSMutableArray</span> *)persons;</span><br><span class="line"></span><br><span class="line"><span class="keyword">@end</span></span><br></pre></td></tr></table></figure>
<p><code>PersonGroup.m</code></p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">//  PersonGroup.m</span></span><br><span class="line"><span class="comment">//  UITableView简单示例</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">//  Created by 武 on 18/1/29.</span></span><br><span class="line"><span class="comment">//  Copyright © 2018年 com. All rights reserved.</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#import <span class="meta-string">"PersonGroup.h"</span></span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">@implementation</span> <span class="title">PersonGroup</span></span></span><br><span class="line"></span><br><span class="line">- (PersonGroup *)initWithName:(<span class="built_in">NSString</span> *)name andDetail:(<span class="built_in">NSString</span> *)detail andPerson:(<span class="built_in">NSMutableArray</span> *)persons</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">self</span>=[<span class="keyword">super</span> init]) &#123;</span><br><span class="line">        <span class="keyword">self</span>.name = name;</span><br><span class="line">        <span class="keyword">self</span>.detail = detail;</span><br><span class="line">        <span class="keyword">self</span>.persons = persons;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">self</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">+ (PersonGroup *)initWithName:(<span class="built_in">NSString</span> *)name andDetail:(<span class="built_in">NSString</span> *)detail andPerson:(<span class="built_in">NSMutableArray</span> *)persons</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">return</span> [[<span class="keyword">self</span> alloc]initWithName:name andDetail:detail andPerson:persons];</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">@end</span></span><br></pre></td></tr></table></figure>
<p><code>ViewController.m</code></p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">//  ViewController.m</span></span><br><span class="line"><span class="comment">//  UITableView简单示例</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">//  Created by 武 on 18/1/29.</span></span><br><span class="line"><span class="comment">//  Copyright © 2018年 com. All rights reserved.</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#import <span class="meta-string">"ViewController.h"</span></span></span><br><span class="line"><span class="meta">#import <span class="meta-string">"Person.h"</span></span></span><br><span class="line"><span class="meta">#import <span class="meta-string">"PersonGroup.h"</span></span></span><br><span class="line"><span class="class"><span class="keyword">@interface</span> <span class="title">ViewController</span> ()&lt;<span class="title">UITableViewDataSource</span>&gt;</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="built_in">UITableView</span> *_tableView;</span><br><span class="line">    <span class="built_in">NSMutableArray</span> *_persondata;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">@end</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">@implementation</span> <span class="title">ViewController</span></span></span><br><span class="line"></span><br><span class="line">- (<span class="keyword">void</span>)viewDidLoad &#123;</span><br><span class="line">    [<span class="keyword">super</span> viewDidLoad];</span><br><span class="line">    </span><br><span class="line">    <span class="comment">//加载数据</span></span><br><span class="line">    [<span class="keyword">self</span> initPersonData];</span><br><span class="line">    <span class="comment">//创建一个分组样式的tableview</span></span><br><span class="line">    _tableView = [[<span class="built_in">UITableView</span> alloc]initWithFrame:<span class="keyword">self</span>.view.bounds style:<span class="built_in">UITableViewStyleGrouped</span>];</span><br><span class="line">    <span class="comment">//设置数据源</span></span><br><span class="line">    _tableView.dataSource = <span class="keyword">self</span>;</span><br><span class="line">    [<span class="keyword">self</span>.view addSubview:_tableView];</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> 加载数据</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">- (<span class="keyword">void</span>)initPersonData</span><br><span class="line">&#123;</span><br><span class="line">    _persondata = [[<span class="built_in">NSMutableArray</span> alloc]init];</span><br><span class="line">    </span><br><span class="line">    Person *peron1 = [Person initWithFirstName:<span class="string">@"zhang"</span> andLastName:<span class="string">@"san"</span> andPhoneNumber:<span class="string">@"1888888888"</span>];</span><br><span class="line">    Person *peron2 = [Person initWithFirstName:<span class="string">@"zhang"</span> andLastName:<span class="string">@"si"</span> andPhoneNumber:<span class="string">@"1777777777"</span>];</span><br><span class="line">    Person *peron3 = [Person initWithFirstName:<span class="string">@"zhang"</span> andLastName:<span class="string">@"wu"</span> andPhoneNumber:<span class="string">@"1666666666"</span>];</span><br><span class="line">    </span><br><span class="line">    PersonGroup *pArray1 = [PersonGroup initWithName:<span class="string">@"Z"</span> andDetail:<span class="string">@"张姓"</span> andPersons:[<span class="built_in">NSMutableArray</span> arrayWithObjects:peron1,peron2,peron3, <span class="literal">nil</span>]];</span><br><span class="line">    </span><br><span class="line">    [_persondata addObject:pArray1];</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">    Person *peron4 = [Person initWithFirstName:<span class="string">@"li"</span> andLastName:<span class="string">@"san"</span> andPhoneNumber:<span class="string">@"1888888888"</span>];</span><br><span class="line">    Person *peron5 = [Person initWithFirstName:<span class="string">@"li"</span> andLastName:<span class="string">@"si"</span> andPhoneNumber:<span class="string">@"1777777777"</span>];</span><br><span class="line">    Person *peron6 = [Person initWithFirstName:<span class="string">@"li"</span> andLastName:<span class="string">@"wu"</span> andPhoneNumber:<span class="string">@"1666666666"</span>];</span><br><span class="line">    </span><br><span class="line">    PersonGroup *pArray2 = [PersonGroup initWithName:<span class="string">@"L"</span> andDetail:<span class="string">@"李姓"</span> andPersons:[<span class="built_in">NSMutableArray</span> arrayWithObjects:peron4,peron5,peron6, <span class="literal">nil</span>]];</span><br><span class="line">    </span><br><span class="line">    [_persondata addObject:pArray2];</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">    Person *peron7 = [Person initWithFirstName:<span class="string">@"wang"</span> andLastName:<span class="string">@"san"</span> andPhoneNumber:<span class="string">@"1888888888"</span>];</span><br><span class="line">    Person *peron8 = [Person initWithFirstName:<span class="string">@"wang"</span> andLastName:<span class="string">@"si"</span> andPhoneNumber:<span class="string">@"1777777777"</span>];</span><br><span class="line">    Person *peron9 = [Person initWithFirstName:<span class="string">@"wang"</span> andLastName:<span class="string">@"wu"</span> andPhoneNumber:<span class="string">@"1666666666"</span>];</span><br><span class="line">    </span><br><span class="line">    PersonGroup *pArray3 = [PersonGroup initWithName:<span class="string">@"W"</span> andDetail:<span class="string">@"王姓"</span> andPersons:[<span class="built_in">NSMutableArray</span> arrayWithObjects:peron7,peron8,peron9, <span class="literal">nil</span>]];</span><br><span class="line">    </span><br><span class="line">    [_persondata addObject:pArray3];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">#pragma mark 数据源方法</span></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> @return 共多少组</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">- (<span class="built_in">NSInteger</span>)numberOfSectionsInTableView:(<span class="built_in">UITableView</span> *)tableView</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">return</span> _persondata.count;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> @param section   那一组</span></span><br><span class="line"><span class="comment"> @return 多少行</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">- (<span class="built_in">NSInteger</span>)tableView:(<span class="built_in">UITableView</span> *)tableView numberOfRowsInSection:(<span class="built_in">NSInteger</span>)section</span><br><span class="line">&#123;</span><br><span class="line">    PersonGroup *group = _persondata[section];</span><br><span class="line">    <span class="keyword">return</span> group.persons.count;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">设置每一行cell数据</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">- (<span class="built_in">UITableViewCell</span> *)tableView:(<span class="built_in">UITableView</span> *)tableView cellForRowAtIndexPath:(<span class="built_in">NSIndexPath</span> *)indexPath</span><br><span class="line">&#123;</span><br><span class="line">    PersonGroup *group = _persondata[indexPath.section];</span><br><span class="line">    Person *person = group.persons[indexPath.row];</span><br><span class="line">    </span><br><span class="line">    <span class="built_in">UITableViewCell</span> *cell = [[<span class="built_in">UITableViewCell</span> alloc]initWithStyle:<span class="built_in">UITableViewCellStyleDefault</span> reuseIdentifier:<span class="literal">nil</span>];</span><br><span class="line">    cell.textLabel.text = [person getName];</span><br><span class="line">    cell.detailTextLabel.text = person.phoneNumber;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> cell;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> @return 每一组的头标题</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">-(<span class="built_in">NSString</span> *)tableView:(<span class="built_in">UITableView</span> *)tableView titleForHeaderInSection:(<span class="built_in">NSInteger</span>)section</span><br><span class="line">&#123;</span><br><span class="line">    PersonGroup *group = _persondata[section];</span><br><span class="line">    <span class="keyword">return</span> group.name;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> @return 每一组的尾标题</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">- (<span class="built_in">NSString</span> *)tableView:(<span class="built_in">UITableView</span> *)tableView titleForFooterInSection:(<span class="built_in">NSInteger</span>)section</span><br><span class="line">&#123;</span><br><span class="line">    PersonGroup *group = _persondata[section];</span><br><span class="line">    <span class="keyword">return</span> group.detail;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> 每组的标题索引</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">- (<span class="built_in">NSArray</span>&lt;<span class="built_in">NSString</span> *&gt; *)sectionIndexTitlesForTableView:(<span class="built_in">UITableView</span> *)tableView</span><br><span class="line">&#123;</span><br><span class="line">    <span class="built_in">NSMutableArray</span> *indexs = [[<span class="built_in">NSMutableArray</span> alloc]init];</span><br><span class="line">    <span class="keyword">for</span> (PersonGroup *group <span class="keyword">in</span> _persondata) &#123;</span><br><span class="line">        [indexs addObject:group.name];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> indexs;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">@end</span></span><br></pre></td></tr></table></figure>
<p>运行结果</p>
<p>​                        <img src="/2018/01/29/UITableView/3.png" alt="效果图"></p>
<p>方法执行顺序为计算分组数(不写此方法默认为1组)—&gt;计算每组的行数—&gt;生成分组索引—&gt;生成单元格(依次生成所有组的单元格)，生成单元格并不是一次全部生成，而是只会生成显示在界面上的单元格。</p>
<h4 id="代理"><a href="#代理" class="headerlink" title="代理"></a>代理</h4><ul>
<li><p>设置行高</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#pragma mark - 代理方法</span></span><br><span class="line"><span class="meta">#pragma mark 设置分组标题内容高度</span></span><br><span class="line">-(<span class="built_in">CGFloat</span>)tableView:(<span class="built_in">UITableView</span> *)tableView heightForHeaderInSection:(<span class="built_in">NSInteger</span>)section&#123;</span><br><span class="line">    <span class="keyword">if</span>(section==<span class="number">0</span>)&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">50</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">40</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">#pragma mark 设置每行高度（每行高度可以不一样）</span></span><br><span class="line">-(<span class="built_in">CGFloat</span>)tableView:(<span class="built_in">UITableView</span> *)tableView heightForRowAtIndexPath:(<span class="built_in">NSIndexPath</span> *)indexPath&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">45</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">#pragma mark 设置尾部说明内容高度</span></span><br><span class="line">-(<span class="built_in">CGFloat</span>)tableView:(<span class="built_in">UITableView</span> *)tableView heightForFooterInSection:(<span class="built_in">NSInteger</span>)section&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">40</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>监听点击事件</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">//  ViewController.m</span></span><br><span class="line"><span class="comment">//  UITableView简单示例</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">//  Created by 武 on 18/1/29.</span></span><br><span class="line"><span class="comment">//  Copyright © 2018年 com. All rights reserved.</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#import <span class="meta-string">"ViewController.h"</span></span></span><br><span class="line"><span class="meta">#import <span class="meta-string">"Person.h"</span></span></span><br><span class="line"><span class="meta">#import <span class="meta-string">"PersonGroup.h"</span></span></span><br><span class="line"><span class="class"><span class="keyword">@interface</span> <span class="title">ViewController</span> ()&lt;<span class="title">UITableViewDataSource</span>,<span class="title">UITableViewDelegate</span>,<span class="title">UIAlertViewDelegate</span>&gt;</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="built_in">UITableView</span> *_tableView;</span><br><span class="line">    <span class="built_in">NSMutableArray</span> *_persondata;</span><br><span class="line">    <span class="built_in">NSIndexPath</span> *_selectIndexPath;<span class="comment">//当前选中的组和行</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">@end</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">@implementation</span> <span class="title">ViewController</span></span></span><br><span class="line"></span><br><span class="line">- (<span class="keyword">void</span>)viewDidLoad &#123;</span><br><span class="line">    [<span class="keyword">super</span> viewDidLoad];</span><br><span class="line">    </span><br><span class="line">    <span class="comment">//加载数据</span></span><br><span class="line">    [<span class="keyword">self</span> initPersonData];</span><br><span class="line">    <span class="comment">//创建一个分组样式的tableview</span></span><br><span class="line">    _tableView = [[<span class="built_in">UITableView</span> alloc]initWithFrame:<span class="keyword">self</span>.view.bounds style:<span class="built_in">UITableViewStyleGrouped</span>];</span><br><span class="line">    <span class="comment">//设置数据源</span></span><br><span class="line">    _tableView.dataSource = <span class="keyword">self</span>;</span><br><span class="line">    _tableView.delegate = <span class="keyword">self</span>;</span><br><span class="line">    [<span class="keyword">self</span>.view addSubview:_tableView];</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> 加载数据</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">- (<span class="keyword">void</span>)initPersonData</span><br><span class="line">&#123;</span><br><span class="line">    _persondata = [[<span class="built_in">NSMutableArray</span> alloc]init];</span><br><span class="line">    </span><br><span class="line">    Person *peron1 = [Person initWithFirstName:<span class="string">@"zhang"</span> andLastName:<span class="string">@"san"</span> andPhoneNumber:<span class="string">@"1888888888"</span>];</span><br><span class="line">    Person *peron2 = [Person initWithFirstName:<span class="string">@"zhang"</span> andLastName:<span class="string">@"si"</span> andPhoneNumber:<span class="string">@"1777777777"</span>];</span><br><span class="line">    Person *peron3 = [Person initWithFirstName:<span class="string">@"zhang"</span> andLastName:<span class="string">@"wu"</span> andPhoneNumber:<span class="string">@"1666666666"</span>];</span><br><span class="line">    </span><br><span class="line">    PersonGroup *pArray1 = [PersonGroup initWithName:<span class="string">@"Z"</span> andDetail:<span class="string">@"张姓"</span> andPersons:[<span class="built_in">NSMutableArray</span> arrayWithObjects:peron1,peron2,peron3, <span class="literal">nil</span>]];</span><br><span class="line">    </span><br><span class="line">    [_persondata addObject:pArray1];</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">    Person *peron4 = [Person initWithFirstName:<span class="string">@"li"</span> andLastName:<span class="string">@"san"</span> andPhoneNumber:<span class="string">@"1888888888"</span>];</span><br><span class="line">    Person *peron5 = [Person initWithFirstName:<span class="string">@"li"</span> andLastName:<span class="string">@"si"</span> andPhoneNumber:<span class="string">@"1777777777"</span>];</span><br><span class="line">    Person *peron6 = [Person initWithFirstName:<span class="string">@"li"</span> andLastName:<span class="string">@"wu"</span> andPhoneNumber:<span class="string">@"1666666666"</span>];</span><br><span class="line">    </span><br><span class="line">    PersonGroup *pArray2 = [PersonGroup initWithName:<span class="string">@"L"</span> andDetail:<span class="string">@"李姓"</span> andPersons:[<span class="built_in">NSMutableArray</span> arrayWithObjects:peron4,peron5,peron6, <span class="literal">nil</span>]];</span><br><span class="line">    </span><br><span class="line">    [_persondata addObject:pArray2];</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">    Person *peron7 = [Person initWithFirstName:<span class="string">@"wang"</span> andLastName:<span class="string">@"san"</span> andPhoneNumber:<span class="string">@"1888888888"</span>];</span><br><span class="line">    Person *peron8 = [Person initWithFirstName:<span class="string">@"wang"</span> andLastName:<span class="string">@"si"</span> andPhoneNumber:<span class="string">@"1777777777"</span>];</span><br><span class="line">    Person *peron9 = [Person initWithFirstName:<span class="string">@"wang"</span> andLastName:<span class="string">@"wu"</span> andPhoneNumber:<span class="string">@"1666666666"</span>];</span><br><span class="line">    </span><br><span class="line">    PersonGroup *pArray3 = [PersonGroup initWithName:<span class="string">@"W"</span> andDetail:<span class="string">@"王姓"</span> andPersons:[<span class="built_in">NSMutableArray</span> arrayWithObjects:peron7,peron8,peron9, <span class="literal">nil</span>]];</span><br><span class="line">    </span><br><span class="line">    [_persondata addObject:pArray3];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">#pragma mark 数据源方法</span></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> @return 共多少组</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">- (<span class="built_in">NSInteger</span>)numberOfSectionsInTableView:(<span class="built_in">UITableView</span> *)tableView</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">return</span> _persondata.count;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> @param section   那一组</span></span><br><span class="line"><span class="comment"> @return 多少行</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">- (<span class="built_in">NSInteger</span>)tableView:(<span class="built_in">UITableView</span> *)tableView numberOfRowsInSection:(<span class="built_in">NSInteger</span>)section</span><br><span class="line">&#123;</span><br><span class="line">    PersonGroup *group = _persondata[section];</span><br><span class="line">    <span class="keyword">return</span> group.persons.count;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">设置每一行cell数据</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">- (<span class="built_in">UITableViewCell</span> *)tableView:(<span class="built_in">UITableView</span> *)tableView cellForRowAtIndexPath:(<span class="built_in">NSIndexPath</span> *)indexPath</span><br><span class="line">&#123;</span><br><span class="line">    PersonGroup *group = _persondata[indexPath.section];</span><br><span class="line">    Person *person = group.persons[indexPath.row];</span><br><span class="line">    </span><br><span class="line">    <span class="built_in">UITableViewCell</span> *cell = [[<span class="built_in">UITableViewCell</span> alloc]initWithStyle:<span class="built_in">UITableViewCellStyleDefault</span> reuseIdentifier:<span class="literal">nil</span>];</span><br><span class="line">    cell.textLabel.text = [person getName];</span><br><span class="line">    cell.detailTextLabel.text = person.phoneNumber;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> cell;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> @return 每一组的头标题</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">-(<span class="built_in">NSString</span> *)tableView:(<span class="built_in">UITableView</span> *)tableView titleForHeaderInSection:(<span class="built_in">NSInteger</span>)section</span><br><span class="line">&#123;</span><br><span class="line">    PersonGroup *group = _persondata[section];</span><br><span class="line">    <span class="keyword">return</span> group.name;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> @return 每一组的尾标题</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">- (<span class="built_in">NSString</span> *)tableView:(<span class="built_in">UITableView</span> *)tableView titleForFooterInSection:(<span class="built_in">NSInteger</span>)section</span><br><span class="line">&#123;</span><br><span class="line">    PersonGroup *group = _persondata[section];</span><br><span class="line">    <span class="keyword">return</span> group.detail;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> 每组的标题索引</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">- (<span class="built_in">NSArray</span>&lt;<span class="built_in">NSString</span> *&gt; *)sectionIndexTitlesForTableView:(<span class="built_in">UITableView</span> *)tableView</span><br><span class="line">&#123;</span><br><span class="line">    <span class="built_in">NSMutableArray</span> *indexs = [[<span class="built_in">NSMutableArray</span> alloc]init];</span><br><span class="line">    <span class="keyword">for</span> (PersonGroup *group <span class="keyword">in</span> _persondata) &#123;</span><br><span class="line">        [indexs addObject:group.name];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> indexs;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">#pragma mark 代理方法</span></span><br><span class="line"></span><br><span class="line">- (<span class="built_in">CGFloat</span>)tableView:(<span class="built_in">UITableView</span> *)tableView heightForHeaderInSection:(<span class="built_in">NSInteger</span>)section</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">if</span> (section==<span class="number">0</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">50</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">40</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (<span class="built_in">CGFloat</span>)tableView:(<span class="built_in">UITableView</span> *)tableView heightForRowAtIndexPath:(<span class="built_in">NSIndexPath</span> *)indexPath</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">45</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (<span class="built_in">CGFloat</span>)tableView:(<span class="built_in">UITableView</span> *)tableView heightForFooterInSection:(<span class="built_in">NSInteger</span>)section</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">40</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (<span class="keyword">void</span>)tableView:(<span class="built_in">UITableView</span> *)tableView didSelectRowAtIndexPath:(<span class="built_in">NSIndexPath</span> *)indexPath</span><br><span class="line">&#123;</span><br><span class="line">    _selectIndexPath = indexPath;</span><br><span class="line">    PersonGroup *group = _persondata[indexPath.section];</span><br><span class="line">    Person *person = group.persons[indexPath.row];</span><br><span class="line">    </span><br><span class="line">    <span class="comment">//创建弹出窗口</span></span><br><span class="line">    <span class="built_in">UIAlertView</span> *alert = [[<span class="built_in">UIAlertView</span> alloc]initWithTitle:<span class="string">@"窗口标题"</span> message:[person getName] delegate:<span class="keyword">self</span> cancelButtonTitle:<span class="string">@"完成"</span> otherButtonTitles:<span class="string">@"OK"</span>, <span class="literal">nil</span>];</span><br><span class="line">    alert.alertViewStyle = <span class="built_in">UIAlertViewStylePlainTextInput</span>;<span class="comment">//设置窗口内容样式</span></span><br><span class="line">    <span class="built_in">UITextField</span> *textField = [alert textFieldAtIndex:<span class="number">0</span>];<span class="comment">//取得文本框</span></span><br><span class="line">    textField.text = person.phoneNumber;<span class="comment">//设置文本框内容为电话</span></span><br><span class="line">    [alert show];<span class="comment">//显示弹出窗口</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">#pragma mark alert代理方法</span></span><br><span class="line">- (<span class="keyword">void</span>)alertView:(<span class="built_in">UIAlertView</span> *)alertView clickedButtonAtIndex:(<span class="built_in">NSInteger</span>)buttonIndex</span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">//当点击了第二个按钮（OK）</span></span><br><span class="line">    <span class="keyword">if</span> (buttonIndex==<span class="number">1</span>) &#123;</span><br><span class="line">        <span class="built_in">UITextField</span> *textField = [alertView textFieldAtIndex:<span class="number">0</span>];</span><br><span class="line">        <span class="comment">//修改模型数据</span></span><br><span class="line">        PersonGroup *group = _persondata[_selectIndexPath.section];</span><br><span class="line">        Person *person = group.persons[_selectIndexPath.row];</span><br><span class="line">        person.phoneNumber = textField.text;</span><br><span class="line">        </span><br><span class="line">        <span class="comment">//[_tableView reloadData];//刷新表格 这种方式不可取需要局部刷新</span></span><br><span class="line">        </span><br><span class="line">        <span class="built_in">NSArray</span> *indexPaths=@[_selectIndexPath];<span class="comment">//需要刷新的单元格的组、行</span></span><br><span class="line">        [_tableView reloadRowsAtIndexPaths:indexPaths withRowAnimation:<span class="built_in">UITableViewRowAnimationLeft</span>];<span class="comment">//最后一个参数代表更新时使用那种动画</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">@end</span></span><br></pre></td></tr></table></figure>
<p><code>注意修改数据后刷新表格尽量使用局部刷新</code></p>
<h4 id="性能优化"><a href="#性能优化" class="headerlink" title="性能优化"></a>性能优化</h4><p>UITableView中的单元格cell时再显示到用户可视区域后创建的，那么如果用户往下滚动就会继续创建显示在屏幕上的单元格，如果用户向上滚动返回到查看过的内容时同样会创建之前已经创建过的单元格，如此一来即使UITableView的内容不是太多，如果用户反复的上下滚动，内存也会瞬间飙升，更何况很多时候UITableView的内容是很多的。</p>
<p>无限滚动UIScrollView是利用有限的UIImageView动态切换其内容来尽可能减少资源占用。同样的，在UITableView中也可以采用类似的方式，只是这时我们不是在滚动到指定位置后更改滚动的位置而是要将当前没有显示的Cell重新显示在将要显示的Cell的位置然后更新其内容。原因就是UITableView中的Cell结构布局可能是不同的，通过重新定位是不可取的，而是需要重用已经不再界面显示的已创建过的Cell.</p>
<p>UITableView内部有一个缓存池，初始化的时候使用<code>initWithStyle:(UITableViewCellStyle) reuseIdentifier:(NSString \*)</code>方法指定一个可重用表示，就可以将这个cell放到缓存池。然后在使用的时候使用指定的标识符取缓存池中取得对应的cell然后修改cell内容即可。</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">设置每一行cell数据</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">- (<span class="built_in">UITableViewCell</span> *)tableView:(<span class="built_in">UITableView</span> *)tableView cellForRowAtIndexPath:(<span class="built_in">NSIndexPath</span> *)indexPath</span><br><span class="line">&#123;</span><br><span class="line">    PersonGroup *group = _persondata[indexPath.section];</span><br><span class="line">    Person *person = group.persons[indexPath.row];</span><br><span class="line">    </span><br><span class="line">    <span class="comment">//方法调用十分频繁，声明成静态变量有利于性能优化</span></span><br><span class="line">    <span class="keyword">static</span> <span class="built_in">NSString</span> *ID = <span class="string">@"person"</span>;</span><br><span class="line">    <span class="comment">//先从缓存中取标识符为ID的cell</span></span><br><span class="line">    <span class="built_in">UITableViewCell</span> *cell = [tableView dequeueReusableCellWithIdentifier:ID];</span><br><span class="line">  	<span class="comment">//如果缓存池中没有标识符为ID的cell再新建一个标识符为ID的cell</span></span><br><span class="line">    <span class="keyword">if</span> (cell==<span class="literal">nil</span>) &#123;</span><br><span class="line">        cell = [[<span class="built_in">UITableViewCell</span> alloc]initWithStyle:<span class="built_in">UITableViewCellStyleDefault</span> reuseIdentifier:ID];</span><br><span class="line">    &#125;</span><br><span class="line">    cell.textLabel.text = [person getName];</span><br><span class="line">    cell.detailTextLabel.text = person.phoneNumber;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> cell;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="自定义TableViewCell-仿照微博"><a href="#自定义TableViewCell-仿照微博" class="headerlink" title="自定义TableViewCell(仿照微博)"></a>自定义TableViewCell(仿照微博)</h4><p>文件结构图</p>
<p><img src="/2018/01/29/UITableView/4.png" alt="文件结构图"></p>
<ul>
<li><p>创建微博模型类</p>
<p><code>Status.h</code></p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">//  Status.h</span></span><br><span class="line"><span class="comment">//  自定义不等高cell</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">//  Created by 武 on 18/1/25.</span></span><br><span class="line"><span class="comment">//  Copyright © 2018年 com. All rights reserved.</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#import <span class="meta-string">&lt;UIKit/UIKit.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">@interface</span> <span class="title">Status</span> : <span class="title">NSObject</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> 图像</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>,<span class="keyword">copy</span>) <span class="built_in">NSString</span> *icon;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> 昵称</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>,<span class="keyword">copy</span>) <span class="built_in">NSString</span> *name;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> 正文内容</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>,<span class="keyword">copy</span>) <span class="built_in">NSString</span> *text;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> VIP</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>,<span class="keyword">assign</span>,<span class="keyword">getter</span>=isVip) <span class="built_in">BOOL</span> vip;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> 配图</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>,<span class="keyword">copy</span>) <span class="built_in">NSString</span> *picture;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> 图像的frame</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>,<span class="keyword">assign</span>)  <span class="built_in">CGRect</span> iconFrame;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> 昵称的frame</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>,<span class="keyword">assign</span>) <span class="built_in">CGRect</span> nameFrame;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> vip的frame</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>,<span class="keyword">assign</span>) <span class="built_in">CGRect</span> vipFrame;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> 正文frame</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>,<span class="keyword">assign</span>) <span class="built_in">CGRect</span> textFrame;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> 配图的frame</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>,<span class="keyword">assign</span>) <span class="built_in">CGRect</span> pictureFrame;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> cell的高度</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>,<span class="keyword">assign</span>) <span class="built_in">CGFloat</span> cellHeight;</span><br><span class="line"><span class="keyword">@end</span></span><br></pre></td></tr></table></figure>
<p><code>Status.m</code></p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">//  Status.m</span></span><br><span class="line"><span class="comment">//  自定义不等高cell</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">//  Created by 武 on 18/1/25.</span></span><br><span class="line"><span class="comment">//  Copyright © 2018年 com. All rights reserved.</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="meta">#import <span class="meta-string">"Status.h"</span></span></span><br><span class="line"><span class="class"><span class="keyword">@implementation</span> <span class="title">Status</span></span></span><br><span class="line">-(<span class="built_in">CGFloat</span>)cellHeight</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">if</span> (_cellHeight == <span class="number">0</span> ) &#123;       </span><br><span class="line">        <span class="built_in">CGFloat</span> space = <span class="number">10</span>;        </span><br><span class="line">        <span class="comment">//图像</span></span><br><span class="line">        <span class="built_in">CGFloat</span> iconX = space;</span><br><span class="line">        <span class="built_in">CGFloat</span> iconY = space;</span><br><span class="line">        <span class="built_in">CGFloat</span> iconWH = <span class="number">30</span>;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">self</span>.iconFrame = <span class="built_in">CGRectMake</span>(iconX, iconY, iconWH, iconWH);</span><br><span class="line">        </span><br><span class="line">        <span class="comment">//昵称</span></span><br><span class="line">        <span class="built_in">CGFloat</span> nameX = <span class="built_in">CGRectGetMaxX</span>(<span class="keyword">self</span>.iconFrame)+space;</span><br><span class="line">        <span class="built_in">CGFloat</span> nameY = iconY;</span><br><span class="line">        <span class="built_in">NSDictionary</span> *nameAtt = @&#123;<span class="built_in">NSFontAttributeName</span>:[<span class="built_in">UIFont</span> systemFontOfSize:<span class="number">17</span>]&#125;;</span><br><span class="line">        <span class="comment">//计算昵称文字的尺寸</span></span><br><span class="line">        <span class="built_in">CGSize</span> nameSize = [<span class="keyword">self</span>.name sizeWithAttributes:nameAtt];</span><br><span class="line">        <span class="built_in">CGFloat</span> nameW = nameSize.width;</span><br><span class="line">        <span class="built_in">CGFloat</span> nameH = nameSize.height;</span><br><span class="line">        <span class="keyword">self</span>.nameFrame = <span class="built_in">CGRectMake</span>(nameX, nameY, nameW, nameH);</span><br><span class="line">        </span><br><span class="line">        <span class="comment">//vip</span></span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">self</span>.isVip) &#123;</span><br><span class="line">            <span class="built_in">CGFloat</span> vipX = <span class="built_in">CGRectGetMaxX</span>(<span class="keyword">self</span>.nameFrame)+space;</span><br><span class="line">            <span class="built_in">CGFloat</span> vipW = <span class="number">14</span>;</span><br><span class="line">            <span class="built_in">CGFloat</span> vipH = nameH;</span><br><span class="line">            <span class="built_in">CGFloat</span> vipY = nameY;</span><br><span class="line">            <span class="keyword">self</span>.vipFrame = <span class="built_in">CGRectMake</span>(vipX, vipY, vipW, vipH);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//正文</span></span><br><span class="line">        <span class="built_in">CGFloat</span> textX = iconX;</span><br><span class="line">        <span class="built_in">CGFloat</span> textY = <span class="built_in">CGRectGetMaxY</span>(<span class="keyword">self</span>.iconFrame)+space;</span><br><span class="line">        <span class="built_in">CGFloat</span> textW = [<span class="built_in">UIScreen</span> mainScreen].bounds.size.width<span class="number">-2</span>*space;</span><br><span class="line">        <span class="built_in">NSDictionary</span> *textAtt = @&#123;<span class="built_in">NSFontAttributeName</span>:[<span class="built_in">UIFont</span> systemFontOfSize:<span class="number">14</span>]&#125;;</span><br><span class="line">        <span class="comment">//最大宽度是textW,宽度不限制</span></span><br><span class="line">        <span class="built_in">CGSize</span> textSize = <span class="built_in">CGSizeMake</span>(textW, MAXFLOAT);</span><br><span class="line">        <span class="built_in">CGFloat</span> textH = [<span class="keyword">self</span>.text boundingRectWithSize:textSize options:<span class="built_in">NSStringDrawingUsesLineFragmentOrigin</span> attributes:textAtt context:<span class="literal">nil</span>].size.height;</span><br><span class="line">        <span class="keyword">self</span>.textFrame = <span class="built_in">CGRectMake</span>(textX, textY, textW, textH);</span><br><span class="line">        </span><br><span class="line">        <span class="comment">//配图</span></span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">self</span>.picture) &#123;</span><br><span class="line">            <span class="built_in">CGFloat</span> pictureWH = <span class="number">100</span>;</span><br><span class="line">            <span class="built_in">CGFloat</span> pictureX = iconX;</span><br><span class="line">            <span class="built_in">CGFloat</span> pictureY = <span class="built_in">CGRectGetMaxY</span>(<span class="keyword">self</span>.textFrame)+space;</span><br><span class="line">            <span class="keyword">self</span>.pictureFrame = <span class="built_in">CGRectMake</span>(pictureX, pictureY, pictureWH, pictureWH);</span><br><span class="line">            _cellHeight = <span class="built_in">CGRectGetMaxY</span>(<span class="keyword">self</span>.pictureFrame)+space;</span><br><span class="line">        &#125;<span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">            _cellHeight = <span class="built_in">CGRectGetMaxY</span>(<span class="keyword">self</span>.textFrame)+space;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> _cellHeight;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">@end</span></span><br></pre></td></tr></table></figure>
<p>​</p>
</li>
<li><p>自定义cell必须继承UITableViewCell类</p>
<p><code>StatusCell.h</code></p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">//  StatusCell.h</span></span><br><span class="line"><span class="comment">//  自定义不等高cell</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">//  Created by 武 on 18/1/26.</span></span><br><span class="line"><span class="comment">//  Copyright © 2018年 com. All rights reserved.</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="meta">#import <span class="meta-string">&lt;UIKit/UIKit.h&gt;</span></span></span><br><span class="line"><span class="class"><span class="keyword">@class</span> <span class="title">Status</span>;</span></span><br><span class="line"><span class="class"><span class="keyword">@interface</span> <span class="title">StatusCell</span> : <span class="title">UITableViewCell</span></span></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> 微博模型</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>,<span class="keyword">strong</span>)  Status *status;</span><br><span class="line"><span class="keyword">@end</span></span><br></pre></td></tr></table></figure>
<p><code>StatusCell.m</code></p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">//  StatusCell.m</span></span><br><span class="line"><span class="comment">//  自定义不等高cell</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">//  Created by 武 on 18/1/26.</span></span><br><span class="line"><span class="comment">//  Copyright © 2018年 com. All rights reserved.</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#import <span class="meta-string">"StatusCell.h"</span></span></span><br><span class="line"><span class="meta">#import <span class="meta-string">"Status.h"</span></span></span><br><span class="line"><span class="class"><span class="keyword">@interface</span> <span class="title">StatusCell</span>()</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> 图像</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>,<span class="keyword">weak</span>) <span class="built_in">UIImageView</span> *iconImageView;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> 昵称</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>,<span class="keyword">weak</span>) <span class="built_in">UILabel</span> *nameLabel;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> vip</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>,<span class="keyword">weak</span>) <span class="built_in">UIImageView</span> *vipImageView;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> 正文</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>,<span class="keyword">weak</span>) <span class="built_in">UILabel</span> *text_Label;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> 配图</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>,<span class="keyword">weak</span>) <span class="built_in">UIImageView</span> *pictureImageView;</span><br><span class="line"><span class="keyword">@end</span></span><br><span class="line"><span class="class"><span class="keyword">@implementation</span> <span class="title">StatusCell</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> 添加子控件的原则：把所有可能显示的子控件都先添加进去</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">-(<span class="keyword">instancetype</span>)initWithStyle:(<span class="built_in">UITableViewCellStyle</span>)style reuseIdentifier:(<span class="built_in">NSString</span> *)reuseIdentifier</span><br><span class="line">&#123;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">self</span> = [<span class="keyword">super</span> initWithStyle:style reuseIdentifier:reuseIdentifier]) &#123;</span><br><span class="line">        <span class="comment">//图像</span></span><br><span class="line">        <span class="built_in">UIImageView</span> *iconImageView = [[<span class="built_in">UIImageView</span> alloc]init];</span><br><span class="line">        [<span class="keyword">self</span>.contentView addSubview:iconImageView];</span><br><span class="line">        <span class="keyword">self</span>.iconImageView = iconImageView;</span><br><span class="line">        </span><br><span class="line">        <span class="comment">//配图</span></span><br><span class="line">        <span class="built_in">UIImageView</span> *pictureImageView = [[<span class="built_in">UIImageView</span> alloc]init];</span><br><span class="line">        [<span class="keyword">self</span>.contentView addSubview:pictureImageView];</span><br><span class="line">        <span class="keyword">self</span>.pictureImageView = pictureImageView;</span><br><span class="line">        </span><br><span class="line">        <span class="comment">//vip</span></span><br><span class="line">        <span class="built_in">UIImageView</span> *vipImageView = [[<span class="built_in">UIImageView</span> alloc]init];</span><br><span class="line">        vipImageView.contentMode = <span class="built_in">UIViewContentModeCenter</span>;</span><br><span class="line">        vipImageView.image = [<span class="built_in">UIImage</span> imageNamed:<span class="string">@"vip"</span>];</span><br><span class="line">        [<span class="keyword">self</span>.contentView addSubview:vipImageView];</span><br><span class="line">        <span class="keyword">self</span>.vipImageView = vipImageView;</span><br><span class="line">        </span><br><span class="line">        <span class="comment">//昵称</span></span><br><span class="line">        <span class="built_in">UILabel</span> *nameLabel = [[<span class="built_in">UILabel</span> alloc]init];</span><br><span class="line">        nameLabel.font = [<span class="built_in">UIFont</span> systemFontOfSize:<span class="number">14</span>];</span><br><span class="line">        [<span class="keyword">self</span>.contentView addSubview:nameLabel];</span><br><span class="line">        <span class="keyword">self</span>.nameLabel = nameLabel;</span><br><span class="line">        </span><br><span class="line">        <span class="comment">//正文</span></span><br><span class="line">        <span class="built_in">UILabel</span> *text_Label = [[<span class="built_in">UILabel</span> alloc]init];</span><br><span class="line">        text_Label.font = [<span class="built_in">UIFont</span> systemFontOfSize:<span class="number">14</span>];</span><br><span class="line">        text_Label.numberOfLines = <span class="number">0</span>;</span><br><span class="line">        [<span class="keyword">self</span>.contentView addSubview:text_Label];</span><br><span class="line">        <span class="keyword">self</span>.text_Label = text_Label;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">self</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"> 设置子控件的数据</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">- (<span class="keyword">void</span>)setStatus:(Status *)status</span><br><span class="line">&#123;</span><br><span class="line">    _status = status;</span><br><span class="line">    <span class="keyword">self</span>.iconImageView.image = [<span class="built_in">UIImage</span> imageNamed:status.icon];</span><br><span class="line">    <span class="keyword">self</span>.nameLabel.text = status.name;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> (status.isVip) &#123;</span><br><span class="line">        <span class="keyword">self</span>.nameLabel.textColor = [<span class="built_in">UIColor</span> orangeColor];</span><br><span class="line">        <span class="keyword">self</span>.vipImageView.hidden = <span class="literal">NO</span>;</span><br><span class="line">    &#125;<span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">self</span>.vipImageView.hidden = <span class="literal">YES</span>;</span><br><span class="line">        <span class="keyword">self</span>.nameLabel.textColor = [<span class="built_in">UIColor</span> blackColor];</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">self</span>.text_Label.text = status.text;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> (status.picture) &#123;</span><br><span class="line">        <span class="keyword">self</span>.pictureImageView.hidden = <span class="literal">NO</span>;</span><br><span class="line">        <span class="keyword">self</span>.pictureImageView.image = [<span class="built_in">UIImage</span> imageNamed:status.picture];</span><br><span class="line">    &#125;<span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">self</span>.pictureImageView.hidden = <span class="literal">YES</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">self</span>.iconImageView.frame = <span class="keyword">self</span>.status.iconFrame;</span><br><span class="line">    <span class="keyword">self</span>.nameLabel.frame = <span class="keyword">self</span>.status.nameFrame;</span><br><span class="line">    <span class="keyword">self</span>.vipImageView.frame = <span class="keyword">self</span>.status.vipFrame;</span><br><span class="line">    <span class="keyword">self</span>.text_Label.frame = <span class="keyword">self</span>.status.textFrame;</span><br><span class="line">    <span class="keyword">self</span>.pictureImageView.frame = <span class="keyword">self</span>.status.pictureFrame;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">@end</span></span><br></pre></td></tr></table></figure>
<p><code>ViewController.m</code></p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">//  ViewController.m</span></span><br><span class="line"><span class="comment">//  自定义不等高cell</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">//  Created by 武 on 18/1/25.</span></span><br><span class="line"><span class="comment">//  Copyright © 2018年 com. All rights reserved.</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#import <span class="meta-string">"ViewController.h"</span></span></span><br><span class="line"><span class="meta">#import <span class="meta-string">"Status.h"</span></span></span><br><span class="line"><span class="meta">#import <span class="meta-string">"MJExtension.h"</span></span></span><br><span class="line"><span class="meta">#import <span class="meta-string">"StatusCell.h"</span></span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">@interface</span> <span class="title">ViewController</span> ()</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>,<span class="keyword">strong</span>) <span class="built_in">NSArray</span> *statues;</span><br><span class="line"></span><br><span class="line"><span class="keyword">@end</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">@implementation</span> <span class="title">ViewController</span></span></span><br><span class="line"></span><br><span class="line">-(<span class="built_in">NSArray</span> *)statues</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">if</span> (_statues==<span class="literal">nil</span>) &#123;</span><br><span class="line">        _statues = [Status mj_objectArrayWithFilename:<span class="string">@"statuses.plist"</span>];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> _statues;</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">NSString</span> *ID = <span class="string">@"status"</span>;</span><br><span class="line"></span><br><span class="line">- (<span class="keyword">void</span>)viewDidLoad &#123;</span><br><span class="line">    [<span class="keyword">super</span> viewDidLoad];   </span><br><span class="line">    <span class="comment">//注册cell</span></span><br><span class="line">    [<span class="keyword">self</span>.tableView registerClass:[StatusCell <span class="keyword">class</span>] forCellReuseIdentifier:ID];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">#pragma mark 数据源方法</span></span><br><span class="line">- (<span class="built_in">NSInteger</span>)tableView:(<span class="built_in">UITableView</span> *)tableView numberOfRowsInSection:(<span class="built_in">NSInteger</span>)section</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">self</span>.statues.count;</span><br><span class="line">&#125;</span><br><span class="line">-(<span class="built_in">UITableViewCell</span> *)tableView:(<span class="built_in">UITableView</span> *)tableView cellForRowAtIndexPath:(<span class="built_in">NSIndexPath</span> *)indexPath</span><br><span class="line">&#123;</span><br><span class="line">    StatusCell *cell = [tableView dequeueReusableCellWithIdentifier:ID];</span><br><span class="line">    </span><br><span class="line">    cell.status = <span class="keyword">self</span>.statues[indexPath.row];</span><br><span class="line">    <span class="keyword">return</span> cell;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">#pragma mark 代理方法</span></span><br><span class="line">- (<span class="built_in">CGFloat</span>)tableView:(<span class="built_in">UITableView</span> *)tableView heightForRowAtIndexPath:(<span class="built_in">NSIndexPath</span> *)indexPath</span><br><span class="line">&#123;</span><br><span class="line">    Status *status = <span class="keyword">self</span>.statues[indexPath.row];</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> status.cellHeight;</span><br><span class="line">&#125;</span><br><span class="line">- (<span class="built_in">BOOL</span>)prefersStatusBarHidden</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">YES</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">@end</span></span><br></pre></td></tr></table></figure>
<h4 id="TableView数据刷新"><a href="#TableView数据刷新" class="headerlink" title="TableView数据刷新"></a>TableView数据刷新</h4><ul>
<li><p>UITableView的刷新方法</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"> (<span class="keyword">void</span>)reloadData;<span class="comment">//刷新整个表格。</span></span><br><span class="line">- (<span class="keyword">void</span>)reloadRowsAtIndexPaths:(<span class="built_in">NSArray</span> *)indexPaths withRowAnimation:(<span class="built_in">UITableViewRowAnimation</span>)animation <span class="built_in">NS_AVAILABLE_IOS</span>(<span class="number">3</span>_0);<span class="comment">//刷新指定的分组和行。</span></span><br><span class="line">- (<span class="keyword">void</span>)reloadSections:(<span class="built_in">NSIndexSet</span> *)sections withRowAnimation:(<span class="built_in">UITableViewRowAnimation</span>)animation <span class="built_in">NS_AVAILABLE_IOS</span>(<span class="number">3</span>_0);<span class="comment">//刷新指定的分组。</span></span><br><span class="line">- (<span class="keyword">void</span>)deleteRowsAtIndexPaths:(<span class="built_in">NSArray</span> *)indexPaths withRowAnimation:(<span class="built_in">UITableViewRowAnimation</span>)animation;<span class="comment">//删除时刷新指定的行数据。</span></span><br><span class="line">- (<span class="keyword">void</span>)insertRowsAtIndexPaths:(<span class="built_in">NSArray</span> *)indexPaths withRowAnimation:(<span class="built_in">UITableViewRowAnimation</span>)animation;<span class="comment">//添加时刷新指定的行数据。</span></span><br></pre></td></tr></table></figure>
<ul>
<li><p>全局刷新</p>
<p><code>示例说明</code>在Main.storyboard中添加一个UIView里面包含3个按钮分别是添加、更新、删除。下面再添加一个TableView。</p>
<p>如下图</p>
<p><img src="/2018/01/29/UITableView/5.png" alt="图5"></p>
<p><code>模型类Wine.h</code></p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">//  Wine.h</span></span><br><span class="line"><span class="comment">//  全局刷新</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">//  Created by 武 on 18/2/1.</span></span><br><span class="line"><span class="comment">//  Copyright © 2018年 com. All rights reserved.</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="meta">#import <span class="meta-string">&lt;Foundation/Foundation.h&gt;</span></span></span><br><span class="line"><span class="class"><span class="keyword">@interface</span> <span class="title">Wine</span> : <span class="title">NSObject</span></span></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> 图标</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>,<span class="keyword">copy</span>) <span class="built_in">NSString</span> *image;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> 价格</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>,<span class="keyword">copy</span>) <span class="built_in">NSString</span> *money;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> 名称</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>,<span class="keyword">copy</span>) <span class="built_in">NSString</span> *name;</span><br><span class="line"><span class="keyword">@end</span></span><br></pre></td></tr></table></figure>
<p><code>自定义cell-WineCell.h</code></p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">//  WineCell.h</span></span><br><span class="line"><span class="comment">//  全局刷新</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">//  Created by 武 on 18/2/1.</span></span><br><span class="line"><span class="comment">//  Copyright © 2018年 com. All rights reserved.</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#import <span class="meta-string">&lt;UIKit/UIKit.h&gt;</span></span></span><br><span class="line"><span class="class"><span class="keyword">@class</span> <span class="title">Wine</span>;</span></span><br><span class="line"><span class="class"><span class="keyword">@interface</span> <span class="title">WineCell</span> : <span class="title">UITableViewCell</span></span></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> 模型属性</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>,<span class="keyword">strong</span>) Wine *wine;</span><br><span class="line"><span class="keyword">@end</span></span><br></pre></td></tr></table></figure>
<p><code>WineCell.m</code></p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">//  WineCell.m</span></span><br><span class="line"><span class="comment">//  全局刷新</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">//  Created by 武 on 18/2/1.</span></span><br><span class="line"><span class="comment">//  Copyright © 2018年 com. All rights reserved.</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="meta">#import <span class="meta-string">"WineCell.h"</span></span></span><br><span class="line"><span class="meta">#import <span class="meta-string">"Wine.h"</span></span></span><br><span class="line"><span class="class"><span class="keyword">@implementation</span> <span class="title">WineCell</span></span></span><br><span class="line"></span><br><span class="line">-(<span class="keyword">void</span>)setWine:(Wine *)wine</span><br><span class="line">&#123;</span><br><span class="line">    _wine = wine;</span><br><span class="line">    <span class="keyword">self</span>.textLabel.text = wine.name;</span><br><span class="line">    <span class="keyword">self</span>.imageView.image = [<span class="built_in">UIImage</span> imageNamed:wine.image];</span><br><span class="line">    <span class="keyword">self</span>.detailTextLabel.text = [<span class="built_in">NSString</span> stringWithFormat:<span class="string">@"¥%@"</span>,wine.money];</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">@end</span></span><br></pre></td></tr></table></figure>
<p><code>ViewController.m</code></p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">//  ViewController.m</span></span><br><span class="line"><span class="comment">//  全局刷新</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">//  Created by 武 on 18/2/1.</span></span><br><span class="line"><span class="comment">//  Copyright © 2018年 com. All rights reserved.</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#import <span class="meta-string">"ViewController.h"</span></span></span><br><span class="line"><span class="meta">#import <span class="meta-string">"MJExtension.h"</span></span></span><br><span class="line"><span class="meta">#import <span class="meta-string">"Wine.h"</span></span></span><br><span class="line"><span class="meta">#import <span class="meta-string">"WineCell.h"</span></span></span><br><span class="line"><span class="class"><span class="keyword">@interface</span> <span class="title">ViewController</span> ()&lt;<span class="title">UITableViewDataSource</span>&gt;</span></span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">weak</span>, <span class="keyword">nonatomic</span>) <span class="keyword">IBOutlet</span> <span class="built_in">UITableView</span> *tableView;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> 所有的数据</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>,<span class="keyword">strong</span>)<span class="built_in">NSMutableArray</span> *wineArray;</span><br><span class="line"></span><br><span class="line"><span class="keyword">@end</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">@implementation</span> <span class="title">ViewController</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> 从plist文件加载数据，使用MJExtension框架</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">-(<span class="built_in">NSMutableArray</span> *)wineArray</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">if</span> (_wineArray==<span class="literal">nil</span>) &#123;</span><br><span class="line">        _wineArray = [Wine mj_objectArrayWithFilename:<span class="string">@"wine.plist"</span>];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> _wineArray;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> 点击添加</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">- (<span class="keyword">IBAction</span>)add &#123;</span><br><span class="line">    <span class="comment">//新建一个模型</span></span><br><span class="line">    Wine *wine = [[Wine alloc]init];</span><br><span class="line">    wine.image = <span class="string">@"newWine"</span>;</span><br><span class="line">    wine.money = <span class="string">@"999.9"</span>;</span><br><span class="line">    wine.name = <span class="string">@"茅台"</span>;</span><br><span class="line">    <span class="comment">// [self.wineArray addObject:wine];//添加到表格最后</span></span><br><span class="line">    [<span class="keyword">self</span>.wineArray insertObject:wine atIndex:<span class="number">0</span>];<span class="comment">//添加到表格第一位</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">//数据发生变化，刷新数据（全局刷新）</span></span><br><span class="line">    [<span class="keyword">self</span>.tableView reloadData];</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> 点击删除</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">- (<span class="keyword">IBAction</span>)delete &#123;</span><br><span class="line">    <span class="comment">// 删除模型</span></span><br><span class="line">    [<span class="keyword">self</span>.wineArray removeObjectAtIndex:<span class="number">0</span>];</span><br><span class="line">    [<span class="keyword">self</span>.wineArray removeObjectAtIndex:<span class="number">0</span>];</span><br><span class="line">    </span><br><span class="line">    <span class="comment">//全局刷新</span></span><br><span class="line">    [<span class="keyword">self</span>.tableView reloadData];</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> 点击更新</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">- (<span class="keyword">IBAction</span>)update &#123;</span><br><span class="line">    <span class="comment">// 更新模型，把价格改为100</span></span><br><span class="line">    Wine *wine = <span class="keyword">self</span>.wineArray[<span class="number">0</span>];</span><br><span class="line">    wine.money = <span class="string">@"100"</span>;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 全局刷新</span></span><br><span class="line">    [<span class="keyword">self</span>.tableView reloadData];</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">#pragma mark 数据源方法</span></span><br><span class="line">- (<span class="built_in">NSInteger</span>)tableView:(<span class="built_in">UITableView</span> *)tableView numberOfRowsInSection:(<span class="built_in">NSInteger</span>)section</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">self</span>.wineArray.count;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">-(<span class="built_in">UITableViewCell</span> *)tableView:(<span class="built_in">UITableView</span> *)tableView cellForRowAtIndexPath:(<span class="built_in">NSIndexPath</span> *)indexPath</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">static</span> <span class="built_in">NSString</span> *ID = <span class="string">@"wine"</span>;</span><br><span class="line">    WineCell *cell = [tableView dequeueReusableCellWithIdentifier:ID];</span><br><span class="line">    <span class="keyword">if</span> (cell==<span class="literal">nil</span>) &#123;</span><br><span class="line">        cell = [[WineCell alloc]initWithStyle:<span class="built_in">UITableViewCellStyleSubtitle</span> reuseIdentifier:ID];</span><br><span class="line">    &#125;</span><br><span class="line">    cell.wine = _wineArray[indexPath.row];</span><br><span class="line">    <span class="keyword">return</span> cell;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">@end</span></span><br></pre></td></tr></table></figure>
<p>运行如下</p>
<p><img src="/2018/01/29/UITableView/6.png" alt="图5"></p>
<ul>
<li><p>局部刷新（操作那一行数据刷新哪一行）</p>
<p><code>修改add、update、delete三个方法的代码如下</code></p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line">- (<span class="keyword">IBAction</span>)add &#123;</span><br><span class="line">    <span class="comment">// 修改模型</span></span><br><span class="line">    XMGWine *wine = [[XMGWine alloc] init];</span><br><span class="line">    wine.image = <span class="string">@"newWine"</span>;</span><br><span class="line">    wine.money = <span class="string">@"56"</span>;</span><br><span class="line">    wine.name = <span class="string">@"杏花村"</span>;</span><br><span class="line">    [<span class="keyword">self</span>.wineArray insertObject:wine atIndex:<span class="number">0</span>];</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 这是全局刷新</span></span><br><span class="line"><span class="comment">//    [self.tableView reloadData];</span></span><br><span class="line">    <span class="comment">// 局部刷新</span></span><br><span class="line">    <span class="built_in">NSArray</span> *indexPaths = @[</span><br><span class="line">                            [<span class="built_in">NSIndexPath</span> indexPathForRow:<span class="number">0</span> inSection:<span class="number">0</span>]</span><br><span class="line">                            ];</span><br><span class="line">    [<span class="keyword">self</span>.tableView insertRowsAtIndexPaths:indexPaths withRowAnimation:<span class="built_in">UITableViewRowAnimationRight</span>];</span><br><span class="line">&#125;</span><br><span class="line">- (<span class="keyword">IBAction</span>)remove &#123;</span><br><span class="line">    <span class="comment">// 修改模型</span></span><br><span class="line">    [<span class="keyword">self</span>.wineArray removeObjectAtIndex:<span class="number">0</span>];</span><br><span class="line">    [<span class="keyword">self</span>.wineArray removeObjectAtIndex:<span class="number">0</span>];</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 局部刷新</span></span><br><span class="line">    <span class="built_in">NSArray</span> *indexPaths = @[</span><br><span class="line">                            [<span class="built_in">NSIndexPath</span> indexPathForRow:<span class="number">0</span> inSection:<span class="number">0</span>],</span><br><span class="line">                            [<span class="built_in">NSIndexPath</span> indexPathForRow:<span class="number">1</span> inSection:<span class="number">0</span>],</span><br><span class="line">                            ];</span><br><span class="line">    [<span class="keyword">self</span>.tableView deleteRowsAtIndexPaths:indexPaths withRowAnimation:<span class="built_in">UITableViewRowAnimationMiddle</span>];</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 这是全局刷新</span></span><br><span class="line"><span class="comment">//    [self.tableView reloadData];</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (<span class="keyword">IBAction</span>)update &#123;</span><br><span class="line">    <span class="comment">// 修改模型</span></span><br><span class="line">    XMGWine *wine = <span class="keyword">self</span>.wineArray[<span class="number">0</span>];</span><br><span class="line">    wine.money = <span class="string">@"100"</span>;</span><br><span class="line">    </span><br><span class="line">    XMGWine *wine2  = <span class="keyword">self</span>.wineArray[<span class="number">1</span>];</span><br><span class="line">    wine2.name = <span class="string">@"呵呵"</span>;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 局部刷新</span></span><br><span class="line">    <span class="built_in">NSArray</span> *indexPaths = @[</span><br><span class="line">                            [<span class="built_in">NSIndexPath</span> indexPathForRow:<span class="number">0</span> inSection:<span class="number">0</span>],</span><br><span class="line">                            [<span class="built_in">NSIndexPath</span> indexPathForRow:<span class="number">1</span> inSection:<span class="number">0</span>]</span><br><span class="line">                            ];</span><br><span class="line">    [<span class="keyword">self</span>.tableView reloadRowsAtIndexPaths:indexPaths withRowAnimation:<span class="built_in">UITableViewRowAnimationLeft</span>];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h5 id="左滑删除"><a href="#左滑删除" class="headerlink" title="左滑删除"></a>左滑删除</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">/**</span><br><span class="line"> 只要实现这个方法，就拥有左滑删除功能</span><br><span class="line"> 点击左滑出现的Delete按钮会调用这个</span><br><span class="line"> */</span><br><span class="line">-(void)tableView:(UITableView *)tableView commitEditingStyle:(UITableViewCellEditingStyle)editingStyle forRowAtIndexPath:(NSIndexPath *)indexPath</span><br><span class="line">&#123;</span><br><span class="line">    NSLog(@&quot;commitEditingStyle--&quot;);</span><br><span class="line">    [self.wineArray removeObjectAtIndex:indexPath.row];</span><br><span class="line">    [self.tableView deleteRowsAtIndexPaths:@[indexPath] withRowAnimation:UITableViewRowAnimationTop];//局部删除删除</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><code>UITableViewRowAction</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">//左滑出现什么按钮</span><br><span class="line">- (NSArray&lt;UITableViewRowAction *&gt; *)tableView:(UITableView *)tableView editActionsForRowAtIndexPath:(NSIndexPath *)indexPath</span><br><span class="line">&#123;</span><br><span class="line">    UITableViewRowAction *action = [UITableViewRowAction rowActionWithStyle:UITableViewRowActionStyleNormal title:@&quot;关注&quot; handler:^(UITableViewRowAction * _Nonnull action, NSIndexPath * _Nonnull indexPath) &#123;</span><br><span class="line">        self.tableView.editing = NO;</span><br><span class="line">    &#125;];</span><br><span class="line">    UITableViewRowAction *action1 = [UITableViewRowAction rowActionWithStyle:UITableViewRowActionStyleDestructive title:@&quot;删除&quot; handler:^(UITableViewRowAction * _Nonnull action, NSIndexPath * _Nonnull indexPath) &#123;</span><br><span class="line">        </span><br><span class="line">        [self.wineArray removeObjectAtIndex:indexPath.row];</span><br><span class="line">        [self.tableView deleteRowsAtIndexPaths:@[indexPath] withRowAnimation:UITableViewRowAnimationAutomatic];</span><br><span class="line">        </span><br><span class="line">    &#125;];</span><br><span class="line">    return @[action,action1];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h5 id="编辑模式"><a href="#编辑模式" class="headerlink" title="编辑模式"></a>编辑模式</h5><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">- (<span class="keyword">IBAction</span>)remove</span><br><span class="line">&#123;</span><br><span class="line">  <span class="comment">//进入编辑模式，点击删除按钮取反</span></span><br><span class="line">  [<span class="keyword">self</span>.tableView setEditing:!<span class="keyword">self</span>.tableView.isEditing animated:<span class="literal">YES</span>];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h5 id="自定义批量删除"><a href="#自定义批量删除" class="headerlink" title="自定义批量删除"></a>自定义批量删除</h5><p><code>在cell里面添加一个打勾的UIImageView的控件并设置尺寸该控件选择的时候显示，默认隐藏</code></p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">//  WineCell.m</span></span><br><span class="line"><span class="comment">//  全局刷新</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">//  Created by 武 on 18/2/1.</span></span><br><span class="line"><span class="comment">//  Copyright © 2018年 com. All rights reserved.</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#import <span class="meta-string">"WineCell.h"</span></span></span><br><span class="line"><span class="meta">#import <span class="meta-string">"Wine.h"</span></span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">@interface</span> <span class="title">WineCell</span>()</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> 打钩控件</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>,<span class="keyword">weak</span>) <span class="built_in">UIImageView</span> *checkedImageView;</span><br><span class="line"></span><br><span class="line"><span class="keyword">@end</span></span><br><span class="line"><span class="class"><span class="keyword">@implementation</span> <span class="title">WineCell</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> 初始化控件</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">- (<span class="keyword">instancetype</span>)initWithStyle:(<span class="built_in">UITableViewCellStyle</span>)style reuseIdentifier:(<span class="built_in">NSString</span> *)reuseIdentifier</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">self</span> = [<span class="keyword">super</span> initWithStyle:style reuseIdentifier:reuseIdentifier]) &#123;</span><br><span class="line">      </span><br><span class="line">        <span class="comment">//添加打勾控件</span></span><br><span class="line">        <span class="built_in">UIImageView</span> *checkImageView = [[<span class="built_in">UIImageView</span> alloc]init];</span><br><span class="line">        checkImageView.hidden = <span class="literal">YES</span>;</span><br><span class="line">        checkImageView.image = [<span class="built_in">UIImage</span> imageNamed:<span class="string">@"check"</span>];</span><br><span class="line">        [<span class="keyword">self</span>.contentView addSubview:checkImageView];</span><br><span class="line">        <span class="keyword">self</span>.checkedImageView = checkImageView;</span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">self</span>;</span><br><span class="line">&#125;</span><br><span class="line">- (<span class="keyword">void</span>)layoutSubviews</span><br><span class="line">&#123;</span><br><span class="line">    [<span class="keyword">super</span> layoutSubviews];</span><br><span class="line">    </span><br><span class="line">    <span class="comment">//设置打勾控件的位置和尺寸</span></span><br><span class="line">    <span class="built_in">CGFloat</span> WH = <span class="number">24</span>;</span><br><span class="line">    <span class="built_in">CGFloat</span> X = <span class="keyword">self</span>.contentView.frame.size.width - WH - <span class="number">10</span>;</span><br><span class="line">    <span class="built_in">CGFloat</span> Y = (<span class="keyword">self</span>.contentView.frame.size.height-WH)*<span class="number">0.5</span>;</span><br><span class="line">    <span class="keyword">self</span>.checkedImageView.frame = <span class="built_in">CGRectMake</span>(X, Y, WH, WH);</span><br><span class="line">    </span><br><span class="line">    <span class="comment">//调整cell textLabel的宽度</span></span><br><span class="line">    <span class="built_in">CGRect</span> frame = <span class="keyword">self</span>.textLabel.frame;</span><br><span class="line">    frame.size.width = <span class="keyword">self</span>.contentView.frame.size.width-WH<span class="number">-20</span>-<span class="keyword">self</span>.textLabel.frame.origin.x;</span><br><span class="line">    <span class="keyword">self</span>.textLabel.frame = frame;</span><br><span class="line">&#125;</span><br><span class="line">-(<span class="keyword">void</span>)setWine:(Wine *)wine</span><br><span class="line">&#123;</span><br><span class="line">    _wine = wine;</span><br><span class="line">    <span class="keyword">self</span>.textLabel.text = wine.name;</span><br><span class="line">    <span class="keyword">self</span>.imageView.image = [<span class="built_in">UIImage</span> imageNamed:wine.image];</span><br><span class="line">    <span class="keyword">self</span>.detailTextLabel.text = [<span class="built_in">NSString</span> stringWithFormat:<span class="string">@"¥%@"</span>,wine.money];</span><br><span class="line">  <span class="comment">//根据模型的checked属性确定打勾控件显示还是隐藏</span></span><br><span class="line">    <span class="keyword">if</span> (wine.isChecked) &#123;</span><br><span class="line">        <span class="keyword">self</span>.checkedImageView.hidden = <span class="literal">NO</span>;</span><br><span class="line">    &#125;<span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">self</span>.checkedImageView.hidden = <span class="literal">YES</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">@end</span></span><br></pre></td></tr></table></figure>
<p><code>在模型类Wine.h里添加一个BOOL属性记录打勾控件的状态</code></p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> 记录打勾控件的状态</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>,<span class="keyword">assign</span>,<span class="keyword">getter</span>=isChecked) <span class="built_in">BOOL</span> checked;</span><br></pre></td></tr></table></figure>
<p><code>ViewController.m</code></p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">//  ViewController.m</span></span><br><span class="line"><span class="comment">//  全局刷新</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">//  Created by 武 on 18/2/1.</span></span><br><span class="line"><span class="comment">//  Copyright © 2018年 com. All rights reserved.</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#import <span class="meta-string">"ViewController.h"</span></span></span><br><span class="line"><span class="meta">#import <span class="meta-string">"MJExtension.h"</span></span></span><br><span class="line"><span class="meta">#import <span class="meta-string">"Wine.h"</span></span></span><br><span class="line"><span class="meta">#import <span class="meta-string">"WineCell.h"</span></span></span><br><span class="line"><span class="class"><span class="keyword">@interface</span> <span class="title">ViewController</span> ()&lt;<span class="title">UITableViewDataSource</span>,<span class="title">UITableViewDelegate</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">weak</span>, <span class="keyword">nonatomic</span>) <span class="keyword">IBOutlet</span> <span class="built_in">UITableView</span> *tableView;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> 所有的数据</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>,<span class="keyword">strong</span>)<span class="built_in">NSMutableArray</span> *wineArray;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> 记录所有选中行的索引</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>,<span class="keyword">strong</span>)<span class="built_in">NSMutableArray</span> *selectedIndexPath;</span><br><span class="line"></span><br><span class="line"><span class="keyword">@end</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">@implementation</span> <span class="title">ViewController</span></span></span><br><span class="line">- (<span class="built_in">NSMutableArray</span> *)selectedIndexPath</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">if</span> (!_selectedIndexPath) &#123;</span><br><span class="line">        _selectedIndexPath = [<span class="built_in">NSMutableArray</span> array];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> _selectedIndexPath;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (<span class="keyword">IBAction</span>)remove &#123;</span><br><span class="line">    <span class="comment">//进入编辑模式，点击删除按钮取反</span></span><br><span class="line">    <span class="comment">//[self.tableView setEditing:!self.tableView.isEditing animated:YES];</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">//获取要删除的所有模型</span></span><br><span class="line">    <span class="built_in">NSMutableArray</span> *deleteWine = [<span class="built_in">NSMutableArray</span> array];</span><br><span class="line">    <span class="keyword">for</span> (<span class="built_in">NSIndexPath</span> *indexPath <span class="keyword">in</span> <span class="keyword">self</span>.selectedIndexPath) &#123;</span><br><span class="line">        [deleteWine addObject:<span class="keyword">self</span>.wineArray[indexPath.row]];</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">//删除模型</span></span><br><span class="line">    [<span class="keyword">self</span>.wineArray removeObjectsInArray:deleteWine];</span><br><span class="line">    </span><br><span class="line">    <span class="comment">//刷新表格</span></span><br><span class="line">    [<span class="keyword">self</span>.tableView deleteRowsAtIndexPaths:<span class="keyword">self</span>.selectedIndexPath withRowAnimation:<span class="built_in">UITableViewRowAnimationAutomatic</span>];</span><br><span class="line">    </span><br><span class="line">    <span class="comment">//注意操作一次必须清空数组，要不然会数组角标越界</span></span><br><span class="line">    [<span class="keyword">self</span>.selectedIndexPath removeAllObjects];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> 从plist文件加载数据，使用MJExtension框架</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">-(<span class="built_in">NSMutableArray</span> *)wineArray</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">if</span> (_wineArray==<span class="literal">nil</span>) &#123;</span><br><span class="line">        _wineArray = [Wine mj_objectArrayWithFilename:<span class="string">@"wine.plist"</span>];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> _wineArray;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>#pragma mark 数据源方法</p>
<ul>
<li>(NSInteger)tableView:(UITableView *)tableView numberOfRowsInSection:(NSInteger)section<br>{<br>  return self.wineArray.count;<br>}</li>
</ul>
<p>-(UITableViewCell <em>)tableView:(UITableView </em>)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath<br>{</p>
<pre><code>static NSString *ID = @&quot;wine&quot;;
WineCell *cell = [tableView dequeueReusableCellWithIdentifier:ID];
if (cell==nil) {
    cell = [[WineCell alloc]initWithStyle:UITableViewCellStyleSubtitle reuseIdentifier:ID];
}
cell.wine = _wineArray[indexPath.row];
return cell;
</code></pre><p>}</p>
<p>#pragma mark - 代理方法<br>/<em>*<br> 只要实现这个方法，就拥有左滑删除功能<br> 点击左滑出现的Delete按钮会调用这个
 </em>/<br>-(void)tableView:(UITableView <em>)tableView commitEditingStyle:(UITableViewCellEditingStyle)editingStyle forRowAtIndexPath:(NSIndexPath </em>)indexPath<br>{</p>
<pre><code>NSLog(@&quot;commitEditingStyle--&quot;);
[self.wineArray removeObjectAtIndex:indexPath.row];
[self.tableView deleteRowsAtIndexPaths:@[indexPath] withRowAnimation:UITableViewRowAnimationTop];//局部删除删除
</code></pre><p>}</p>
<ul>
<li><p>(NSArray<uitableviewrowaction *=""> <em>)tableView:(UITableView </em>)tableView editActionsForRowAtIndexPath:(NSIndexPath <em>)indexPath<br>{<br>  UITableViewRowAction </em>action = [UITableViewRowAction rowActionWithStyle:UITableViewRowActionStyleNormal title:@”关注” handler:^(UITableViewRowAction <em> _Nonnull action, NSIndexPath </em> _Nonnull indexPath) {</uitableviewrowaction></p>
<pre><code>self.tableView.editing = NO;
</code></pre><p>  }];<br>  UITableViewRowAction <em>action1 = [UITableViewRowAction rowActionWithStyle:UITableViewRowActionStyleDestructive title:@”删除” handler:^(UITableViewRowAction </em> _Nonnull action, NSIndexPath * _Nonnull indexPath) {</p>
<pre><code>[self.wineArray removeObjectAtIndex:indexPath.row];
[self.tableView deleteRowsAtIndexPaths:@[indexPath] withRowAnimation:UITableViewRowAnimationAutomatic];
</code></pre><p>  }];<br>  return @[action,action1];<br>}<br>//选择那一行的操作</p>
</li>
<li><p>(void)tableView:(UITableView <em>)tableView didSelectRowAtIndexPath:(NSIndexPath </em>)indexPath<br>{<br>  //修改模型<br>  Wine *wine = self.wineArray[indexPath.row];<br>  if (wine.isChecked) {//之前是打勾的就取反</p>
<pre><code>wine.checked = NO;
[self.selectedIndexPath removeObject:indexPath];
</code></pre><p>  }else<br>  {//之前不是打勾的，现在打勾</p>
<pre><code>wine.checked = YES;
[self.selectedIndexPath addObject:indexPath];
</code></pre><p>  }</p>
<p>  //局部刷新表格<br>  [self.tableView reloadRowsAtIndexPaths:@[indexPath] withRowAnimation:UITableViewRowAnimationAutomatic];<br>}<br>@end<br>```</p>
</li>
</ul>
<p>运行效果</p>
<p><img src="/2018/01/29/UITableView/7.png" alt="图7"></p>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<p>​</p>
</li>
</ul>
]]></content>
      
        <categories>
            
            <category> iOS开发 </category>
            
        </categories>
        
        
        <tags>
            
            <tag> iOS </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[UIScrollView]]></title>
      <url>/2018/01/29/UIScrollView/</url>
      <content type="html"><![CDATA[<h4 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h4><p>UIScrollView是UIView的子类，这是一个可以处理滚动操作的UI控件在开发过程中使用很频繁。</p>
<h4 id="属性"><a href="#属性" class="headerlink" title="属性"></a>属性</h4><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">@property</span>(<span class="keyword">nonatomic</span>) <span class="built_in">CGPoint</span> contentOffset;<span class="comment">//内容偏移量，当前显示的内容得顶点相对此控件顶点x,y轴之间的距离，默认为CGPointZero</span></span><br><span class="line"><span class="keyword">@property</span>(<span class="keyword">nonatomic</span>) <span class="built_in">CGSize</span> contentSize;<span class="comment">//控件内容大小，不一定在显示区域，如果这个属性不设置，此控件将无法滚动，默认为CGSizeZero;</span></span><br><span class="line"><span class="keyword">@property</span>(<span class="keyword">nonatomic</span>) <span class="built_in">UIEdgeInsets</span> contentInset;<span class="comment">//控件四周边距，类似于css中的margin，注意边距不座位其内容的一部分，默认为UIEdgeInsertZero;</span></span><br><span class="line"><span class="keyword">@property</span>(<span class="keyword">nonatomic</span>,<span class="keyword">assign</span>) <span class="keyword">id</span>&lt;<span class="built_in">UIScrollViewDelegate</span>&gt; delegate; <span class="comment">//控件代理，一般用于事件监听，在iOS中多数控件都是通过代理来进行事件监听的</span></span><br><span class="line"><span class="keyword">@property</span>(<span class="keyword">nonatomic</span>) <span class="built_in">BOOL</span> bounces;<span class="comment">//启用弹簧效果，启用弹簧效果后拖动到边缘可以看到内容后面的背景，默认设置为YES</span></span><br><span class="line"><span class="keyword">@property</span>(<span class="keyword">nonatomic</span>,<span class="keyword">getter</span>=isPagingEnabled)<span class="built_in">BOOL</span> pagingEnabled;<span class="comment">//是否分页，如果分页的话每次左右拖动的距离只屏幕宽度的整倍数，默认设置为NO</span></span><br><span class="line"><span class="keyword">@property</span>(<span class="keyword">nonatomic</span>,<span class="keyword">getter</span>=isScrollEnabled)<span class="built_in">BOOL</span> scrollEnabled;<span class="comment">//是否启用滚动，默认也YES</span></span><br><span class="line"><span class="keyword">@property</span>(<span class="keyword">nonatomic</span>) <span class="built_in">BOOL</span> showsHorizontalScrollIndicator;<span class="comment">//是否显示横向滚动条，默认为YES</span></span><br><span class="line"><span class="keyword">@property</span>(<span class="keyword">nonatomic</span>) <span class="built_in">BOOL</span> showsVerticalScrollIndicator;<span class="comment">//是否显示纵向滚动条，默认为YES</span></span><br><span class="line"><span class="keyword">@property</span>(<span class="keyword">nonatomic</span>) <span class="built_in">CGFloat</span> minimumZoomScale;<span class="comment">//最小缩放倍数，默认为1.0</span></span><br><span class="line"><span class="keyword">@property</span>(<span class="keyword">nonatomic</span>) <span class="built_in">CGFloat</span> maximumZoomScale;<span class="comment">//最大缩放倍数(注意只有maximumZoomScale大于minimumZoomScale才有可能缩放)默认为1.0</span></span><br><span class="line"><span class="keyword">@property</span>(<span class="keyword">nonatomic</span>,<span class="keyword">readonly</span>,<span class="keyword">getter</span>= isTracking)<span class="built_in">BOOL</span> tracking;<span class="comment">//状态是否被追踪，手指按下去并且还没有拖动的时候是YES，其他情况均为NO</span></span><br><span class="line"><span class="keyword">@property</span>(<span class="keyword">nonatomic</span>,<span class="keyword">readonly</span>,<span class="keyword">getter</span>= isDragging)<span class="built_in">BOOL</span> dragging;<span class="comment">//判断状态是否被拖拽</span></span><br><span class="line"><span class="keyword">@property</span>(<span class="keyword">nonatomic</span>,<span class="keyword">readonly</span>,<span class="keyword">getter</span>=isDecelerating)<span class="built_in">BOOL</span> decelerating;<span class="comment">//判断状态是否减速</span></span><br><span class="line"><span class="keyword">@property</span>(<span class="keyword">nonatomic</span>,<span class="keyword">readonly</span>,<span class="keyword">getter</span>=isZomming)<span class="built_in">BOOL</span> zomming;<span class="comment">//判断状态是否缩放</span></span><br></pre></td></tr></table></figure>
<h4 id="方法"><a href="#方法" class="headerlink" title="方法"></a>方法</h4><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">- (<span class="keyword">void</span>)setContentOffset:(<span class="built_in">CGPoint</span>)contentOffset animated:(<span class="built_in">BOOL</span>)animated;<span class="comment">//设置滚动位置，第二个参数表示是否启用动画效果</span></span><br><span class="line">- (<span class="keyword">void</span>)scrollRectToVisible:(<span class="built_in">CGRect</span>)rect animated:(<span class="built_in">BOOL</span>)animated;<span class="comment">//滚动并显示指定区域的内容，第二个参数表示是否启用动画效果</span></span><br></pre></td></tr></table></figure>
<h4 id="代理方法"><a href="#代理方法" class="headerlink" title="代理方法"></a>代理方法</h4><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">- (<span class="keyword">void</span>)scrollViewDidScroll:(<span class="built_in">UIScrollView</span> *)scrollView;<span class="comment">//滚动事件方法，滚动过程中会一直循环执行</span></span><br><span class="line">- (<span class="keyword">void</span>)scrollViewWillBeginDragging:(<span class="built_in">UIScrollView</span> *)scrollView;<span class="comment">//开始拖拽事件</span></span><br><span class="line">- (<span class="keyword">void</span>)scrollViewDidEndDragging:(<span class="built_in">UIScrollView</span> *)scrollView willDecelerate:(<span class="built_in">BOOL</span>)decelerate;<span class="comment">//拖拽操作完成事件方法</span></span><br><span class="line">- (<span class="keyword">void</span>)scrollViewWillBeginDecelerating:(<span class="built_in">UIScrollView</span> *)scrollView;<span class="comment">//即将停止滚动事件方法（拖拽松开后开始减速时执行）</span></span><br><span class="line">- (<span class="keyword">void</span>)scrollViewDidEndDecelerating:(<span class="built_in">UIScrollView</span> *)scrollView;<span class="comment">//滚动停止事件方法（滚动过程中减速停止后执行）</span></span><br><span class="line">- (<span class="keyword">void</span>)scrollViewWillBeginZooming:(<span class="built_in">UIScrollView</span> *)scrollView withView:(<span class="built_in">UIView</span> *)view <span class="built_in">NS_AVAILABLE_IOS</span>(<span class="number">3</span>_2);<span class="comment">//开始缩放事件方法</span></span><br><span class="line">- (<span class="keyword">void</span>)scrollViewDidZoom:(<span class="built_in">UIScrollView</span> *)scrollView <span class="built_in">NS_AVAILABLE_IOS</span>(<span class="number">3</span>_2);<span class="comment">//缩放操作完成事件方法</span></span><br><span class="line">- (<span class="built_in">UIView</span> *)viewForZoomingInScrollView:(<span class="built_in">UIScrollView</span> *)scrollView;<span class="comment">//返回缩放视图，注意只有实现这个代理方法才能进行缩放，此方法返回需要缩放的视图</span></span><br></pre></td></tr></table></figure>
<h4 id="简单示例"><a href="#简单示例" class="headerlink" title="简单示例"></a>简单示例</h4><ul>
<li><p>ViewController.h</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">//  ViewController.h</span></span><br><span class="line"><span class="comment">//  UIScrollView-1</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">//  Created by 武 on 18/1/29.</span></span><br><span class="line"><span class="comment">//  Copyright © 2018年 com. All rights reserved.</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="meta">#import <span class="meta-string">&lt;UIKit/UIKit.h&gt;</span></span></span><br><span class="line"><span class="class"><span class="keyword">@interface</span> <span class="title">ViewController</span> : <span class="title">UIViewController</span></span></span><br><span class="line">  </span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>,<span class="keyword">strong</span>) <span class="built_in">UIScrollView</span> *scrollview;</span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>,<span class="keyword">strong</span>) <span class="built_in">UIImageView</span> *imageView;</span><br><span class="line"></span><br><span class="line"><span class="keyword">@end</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>ViewController.m</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">//  ViewController.m</span></span><br><span class="line"><span class="comment">//  UIScrollView-1</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">//  Created by 武 on 18/1/29.</span></span><br><span class="line"><span class="comment">//  Copyright © 2018年 com. All rights reserved.</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#import <span class="meta-string">"ViewController.h"</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">//实现UIScrollView代理</span></span><br><span class="line"><span class="class"><span class="keyword">@interface</span> <span class="title">ViewController</span> ()&lt;<span class="title">UIScrollViewDelegate</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">@end</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">@implementation</span> <span class="title">ViewController</span></span></span><br><span class="line"></span><br><span class="line">- (<span class="keyword">void</span>)viewDidLoad &#123;</span><br><span class="line">    [<span class="keyword">super</span> viewDidLoad];</span><br><span class="line">    </span><br><span class="line">    <span class="comment">//添加scrollview控件</span></span><br><span class="line">    <span class="comment">//注意UIScreen代表当前屏幕对象，applicationFrame是当前屏幕内容区域</span></span><br><span class="line">    _scrollview = [[<span class="built_in">UIScrollView</span> alloc]initWithFrame:[<span class="built_in">UIScreen</span> mainScreen].applicationFrame];</span><br><span class="line">    _scrollview.contentMode = <span class="built_in">UIViewContentModeScaleToFill</span>;</span><br><span class="line">    [<span class="keyword">self</span>.view addSubview:_scrollview];</span><br><span class="line">    </span><br><span class="line">    <span class="comment">//添加图片控件</span></span><br><span class="line">    <span class="built_in">UIImage</span> *image = [<span class="built_in">UIImage</span> imageNamed:<span class="string">@"timg"</span>];</span><br><span class="line">    _imageView = [[<span class="built_in">UIImageView</span> alloc]initWithImage:image];</span><br><span class="line">    [_scrollview addSubview:_imageView];</span><br><span class="line">    </span><br><span class="line">    <span class="comment">//contentSize必须设置，否则无法滚动，当前设置为图片大小</span></span><br><span class="line">    _scrollview.contentSize = _imageView.frame.size;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">//实现缩放：maxinumZoomScale必须大于minimumZoomScale同时实现viewForZoomingInScrollView方法</span></span><br><span class="line">    _scrollview.minimumZoomScale = <span class="number">0.6</span>;</span><br><span class="line">    _scrollview.maximumZoomScale = <span class="number">3.0</span>;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">//设置代理为viewController</span></span><br><span class="line">    _scrollview.delegate = <span class="keyword">self</span>;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">//边距，不属于内容部分，内容坐标（0，0）指的是内容的左上角不包括边界</span></span><br><span class="line">    <span class="comment">//_scrollView.contentInset=UIEdgeInsetsMake(10, 20, 10, 20);</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">//显示滚动内容的指定位置</span></span><br><span class="line">    <span class="comment">//_scrollView.contentOffset=CGPointMake(10, 0);</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">//隐藏滚动条</span></span><br><span class="line">    _scrollview.showsHorizontalScrollIndicator = <span class="literal">NO</span>;</span><br><span class="line">    _scrollview.showsVerticalScrollIndicator = <span class="literal">NO</span>;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">//禁用弹簧效果</span></span><br><span class="line">    <span class="comment">//_scrollView.bounces=NO;</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">#pragma mark 代理方法</span></span><br><span class="line">- (<span class="built_in">UIView</span> *)viewForZoomingInScrollView:(<span class="built_in">UIScrollView</span> *)scrollView</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">return</span> _imageView;</span><br><span class="line">&#125;</span><br><span class="line">- (<span class="keyword">void</span>)scrollViewWillBeginDecelerating:(<span class="built_in">UIScrollView</span> *)scrollView</span><br><span class="line">&#123;</span><br><span class="line">    <span class="built_in">NSLog</span>(<span class="string">@"scrollViewWillBeginDecelerating"</span>);</span><br><span class="line">&#125;</span><br><span class="line">- (<span class="keyword">void</span>)scrollViewDidEndDecelerating:(<span class="built_in">UIScrollView</span> *)scrollView</span><br><span class="line">&#123;</span><br><span class="line">    <span class="built_in">NSLog</span>(<span class="string">@"scrollViewDidEndDecelerating"</span>);</span><br><span class="line">&#125;</span><br><span class="line">-(<span class="keyword">void</span>)scrollViewWillBeginDragging:(<span class="built_in">UIScrollView</span> *)scrollView&#123;</span><br><span class="line">    <span class="built_in">NSLog</span>(<span class="string">@"scrollViewWillBeginDragging"</span>);</span><br><span class="line">&#125;</span><br><span class="line">-(<span class="keyword">void</span>)scrollViewDidEndDragging:(<span class="built_in">UIScrollView</span> *)scrollView willDecelerate:(<span class="built_in">BOOL</span>)decelerate&#123;</span><br><span class="line">    <span class="built_in">NSLog</span>(<span class="string">@"scrollViewDidEndDragging"</span>);</span><br><span class="line">&#125;</span><br><span class="line">-(<span class="keyword">void</span>)scrollViewWillBeginZooming:(<span class="built_in">UIScrollView</span> *)scrollView withView:(<span class="built_in">UIView</span> *)view&#123;</span><br><span class="line">    <span class="built_in">NSLog</span>(<span class="string">@"scrollViewWillBeginZooming"</span>);</span><br><span class="line">&#125;</span><br><span class="line">-(<span class="keyword">void</span>)scrollViewDidEndZooming:(<span class="built_in">UIScrollView</span> *)scrollView withView:(<span class="built_in">UIView</span> *)view atScale:(<span class="built_in">CGFloat</span>)scale&#123;</span><br><span class="line">    <span class="built_in">NSLog</span>(<span class="string">@"scrollViewDidEndZooming"</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">#pragma mark 当图片小于屏幕宽高时缩放后让图片显示到屏幕中间</span></span><br><span class="line">- (<span class="keyword">void</span>)scrollViewDidZoom:(<span class="built_in">UIScrollView</span> *)scrollView</span><br><span class="line">&#123;</span><br><span class="line">    <span class="built_in">CGSize</span> originalSize = _scrollview.bounds.size;</span><br><span class="line">    <span class="built_in">CGSize</span> contentSize = _scrollview.contentSize;</span><br><span class="line">    <span class="comment">//计算偏移量X轴</span></span><br><span class="line">    <span class="built_in">CGFloat</span> offSetx = originalSize.width&gt;contentSize.width?(originalSize.width-contentSize.width)/<span class="number">2</span>:<span class="number">0</span>;</span><br><span class="line">    <span class="comment">//计算偏移量Y轴</span></span><br><span class="line">    <span class="built_in">CGFloat</span> offSetY = originalSize.height&gt;contentSize.height?(originalSize.height-contentSize.height)/<span class="number">2</span>:<span class="number">0</span>;</span><br><span class="line">    </span><br><span class="line">    _imageView.center = <span class="built_in">CGPointMake</span>(contentSize.width/<span class="number">2</span>+offSetx, contentSize.height/<span class="number">2</span>+offSetY);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">@end</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>效果如下图</p>
<p><img src="/2018/01/29/UIScrollView/1.png" alt="效果图"></p>
<p>​</p>
</li>
</ul>
<h4 id="UIScrollView实战-实现无限循环"><a href="#UIScrollView实战-实现无限循环" class="headerlink" title="UIScrollView实战-实现无限循环"></a>UIScrollView实战-实现无限循环</h4><ul>
<li>说明<ul>
<li><code>如何无限循环</code>一种是无限循环叠加图片，另一种就是如果最后一张图片浏览完立即显示第一张图片。很明显第一种方法是不现实的，使用第二种方式。其实使用第二种方式实现原理比较简单，只要在图片前后各放一张图片即可（此时共有n+2个图片在UIScrollView中）。例如我们有5张图片，只要使用7个UIImageView依次存放：图片5，图片1，图片2，图片3，图片4，图片5，图片1。当从图片1滚动到图片5时由于最后一张是图片1就给用户一种无限循环的感觉，当这张图完全显示后我们迅速将UIScrollView的contentOffset设置到第二个UIImageView，也就是图片1，接着用户可以继续向后滚动。当然向前滚动原理完全一样，当滚动到第一张图片（图片5）就迅速设置UIScrollView的contentOffset显示第6张图（图片5）。</li>
<li><code>如何优化性能</code>如果图片过多这些图片势必全部加载到内存消耗很大，其实完全没必要创建n+2个UIImageView，其实3个已经足够，只要一直保持显示中间的UIImageView，滚动时动态更改三个UIImageView的图片即可。例如三个UIImageView默认放图片5、图片1、图片2，当前显示中间的UIImageView，也就是图片1,。如果向后滚动那么就会显示图片2，当图片2显示完整后迅速重新设置三个UIImageView的内容为图片1、图片2、图片3，然后通过contentOffset设置显示中间的UIImageView，也就是图片2。继续向后看到图片3，当图片3滚动完成迅速重新设置3个UIImageView的内容为图片2、图片3、图片4，然后设置contentOffset显示中间的UIImageView，也就是图片3。当然，向前滚动原理完全一样，如此就给用户一种循环错觉，而且不占用过多内存。</li>
</ul>
</li>
</ul>
<ul>
<li><p>通过解析plist文件来加载图片数据</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span><br><span class="line">&lt;!DOCTYPE plist PUBLIC &quot;-//Apple//DTD PLIST 1.0//EN&quot; &quot;http://www.apple.com/DTDs/PropertyList-1.0.dtd&quot;&gt;</span><br><span class="line">&lt;plist version=&quot;1.0&quot;&gt;</span><br><span class="line">&lt;dict&gt;</span><br><span class="line">    &lt;key&gt;0.jpg&lt;/key&gt;</span><br><span class="line">    &lt;string&gt;图0&lt;/string&gt;</span><br><span class="line">    &lt;key&gt;1.jpg&lt;/key&gt;</span><br><span class="line">    &lt;string&gt;图1&lt;/string&gt;</span><br><span class="line">    &lt;key&gt;2.jpg&lt;/key&gt;</span><br><span class="line">    &lt;string&gt;图2&lt;/string&gt;</span><br><span class="line">    &lt;key&gt;3.jpg&lt;/key&gt;</span><br><span class="line">    &lt;string&gt;图3&lt;/string&gt;</span><br><span class="line">    &lt;key&gt;4.jpg&lt;/key&gt;</span><br><span class="line">    &lt;string&gt;图4&lt;/string&gt;</span><br><span class="line">    &lt;key&gt;5.jpg&lt;/key&gt;</span><br><span class="line">    &lt;string&gt;图5&lt;/string&gt;</span><br><span class="line">    &lt;key&gt;6.jpg&lt;/key&gt;</span><br><span class="line">    &lt;string&gt;图6&lt;/string&gt;</span><br><span class="line">    &lt;key&gt;7.jpg&lt;/key&gt;</span><br><span class="line">    &lt;string&gt;图7&lt;/string&gt;</span><br><span class="line">    &lt;key&gt;8.jpg&lt;/key&gt;</span><br><span class="line">    &lt;string&gt;图8&lt;/string&gt;</span><br><span class="line">&lt;/dict&gt;</span><br><span class="line">&lt;/plist&gt;</span><br></pre></td></tr></table></figure>
</li>
<li><p>ViewController.m</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">//  ViewController.m</span></span><br><span class="line"><span class="comment">//  无限滚动图片</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">//  Created by 武 on 18/1/29.</span></span><br><span class="line"><span class="comment">//  Copyright © 2018年 com. All rights reserved.</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#import <span class="meta-string">"ViewController.h"</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#define SCREEN_WIDTH 320</span></span><br><span class="line"><span class="meta">#define SCREEN_HEIGHT 568</span></span><br><span class="line"><span class="meta">#define IMAGEVIEW_COUNT 3</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">@interface</span> <span class="title">ViewController</span> ()&lt;<span class="title">UIScrollViewDelegate</span>&gt;</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="built_in">UIScrollView</span> *_scrollView;</span><br><span class="line">    <span class="built_in">UIImageView</span> *_leftImageView;</span><br><span class="line">    <span class="built_in">UIImageView</span> *_centerImageView;</span><br><span class="line">    <span class="built_in">UIImageView</span> *_rightImageView;</span><br><span class="line">    <span class="built_in">UIPageControl</span> *_pageControl;</span><br><span class="line">    <span class="built_in">UILabel</span> *_label;</span><br><span class="line">    <span class="built_in">NSMutableDictionary</span> *_imageData;<span class="comment">//图片数据</span></span><br><span class="line">    <span class="keyword">int</span> _currentImageIndex;<span class="comment">//当前图片索引</span></span><br><span class="line">    <span class="keyword">int</span> _imageCount;<span class="comment">//图片总数</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">@end</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">@implementation</span> <span class="title">ViewController</span></span></span><br><span class="line"></span><br><span class="line">- (<span class="keyword">void</span>)viewDidLoad &#123;</span><br><span class="line">    [<span class="keyword">super</span> viewDidLoad];</span><br><span class="line">    </span><br><span class="line">    <span class="comment">//加载数据</span></span><br><span class="line">    [<span class="keyword">self</span> loadImageData];</span><br><span class="line">    <span class="comment">//添加滚动控件</span></span><br><span class="line">    [<span class="keyword">self</span> addScrollView];</span><br><span class="line">    <span class="comment">//添加图片控件</span></span><br><span class="line">    [<span class="keyword">self</span> addImageViews];</span><br><span class="line">    <span class="comment">//添加分页控件</span></span><br><span class="line">    [<span class="keyword">self</span> addPageControl];</span><br><span class="line">    <span class="comment">//添加图片信息描述控件</span></span><br><span class="line">    [<span class="keyword">self</span> addLabel];</span><br><span class="line">    <span class="comment">//加载默认图片</span></span><br><span class="line">    [<span class="keyword">self</span> setDefaultImage];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">#pragma mark 加载图片数据</span></span><br><span class="line">- (<span class="keyword">void</span>)loadImageData</span><br><span class="line">&#123;</span><br><span class="line">    <span class="built_in">NSString</span> *path = [[<span class="built_in">NSBundle</span> mainBundle]pathForResource:<span class="string">@"imageInfo"</span> ofType:<span class="string">@"plist"</span>];</span><br><span class="line">    _imageData = [<span class="built_in">NSMutableDictionary</span> dictionaryWithContentsOfFile:path];</span><br><span class="line">    _imageCount = _imageData.count;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">#pragma mark 添加控件</span></span><br><span class="line">- (<span class="keyword">void</span>)addScrollView</span><br><span class="line">&#123;</span><br><span class="line">    _scrollView = [[<span class="built_in">UIScrollView</span> alloc]initWithFrame:[<span class="built_in">UIScreen</span> mainScreen].bounds];</span><br><span class="line">    [<span class="keyword">self</span>.view addSubview:_scrollView];</span><br><span class="line">    </span><br><span class="line">    <span class="comment">//设置代理</span></span><br><span class="line">    _scrollView.delegate = <span class="keyword">self</span>;</span><br><span class="line">    <span class="comment">//设置contentSize</span></span><br><span class="line">    _scrollView.contentSize = <span class="built_in">CGSizeMake</span>(IMAGEVIEW_COUNT*SCREEN_WIDTH, SCREEN_HEIGHT);</span><br><span class="line">    <span class="comment">//设置当前显示的位置为中间图片</span></span><br><span class="line">    [_scrollView setContentOffset:<span class="built_in">CGPointMake</span>(SCREEN_WIDTH, <span class="number">0</span>) animated:<span class="literal">NO</span>];</span><br><span class="line">    <span class="comment">//设置分页</span></span><br><span class="line">    _scrollView.pagingEnabled=<span class="literal">YES</span>;</span><br><span class="line">    <span class="comment">//去掉滚动条</span></span><br><span class="line">    _scrollView.showsHorizontalScrollIndicator=<span class="literal">NO</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">#pragma mark 添加图片三个控件</span></span><br><span class="line">-(<span class="keyword">void</span>)addImageViews&#123;</span><br><span class="line">    _leftImageView=[[<span class="built_in">UIImageView</span> alloc]initWithFrame:<span class="built_in">CGRectMake</span>(<span class="number">0</span>, <span class="number">0</span>, SCREEN_WIDTH, SCREEN_HEIGHT)];</span><br><span class="line">    _leftImageView.contentMode=<span class="built_in">UIViewContentModeScaleAspectFit</span>;</span><br><span class="line">    [_scrollView addSubview:_leftImageView];</span><br><span class="line">    _centerImageView=[[<span class="built_in">UIImageView</span> alloc]initWithFrame:<span class="built_in">CGRectMake</span>(SCREEN_WIDTH, <span class="number">0</span>, SCREEN_WIDTH, SCREEN_HEIGHT)];</span><br><span class="line">    _centerImageView.contentMode=<span class="built_in">UIViewContentModeScaleAspectFit</span>;</span><br><span class="line">    [_scrollView addSubview:_centerImageView];</span><br><span class="line">    _rightImageView=[[<span class="built_in">UIImageView</span> alloc]initWithFrame:<span class="built_in">CGRectMake</span>(<span class="number">2</span>*SCREEN_WIDTH, <span class="number">0</span>, SCREEN_WIDTH, SCREEN_HEIGHT)];</span><br><span class="line">    _rightImageView.contentMode=<span class="built_in">UIViewContentModeScaleAspectFit</span>;</span><br><span class="line">    [_scrollView addSubview:_rightImageView];</span><br><span class="line">    </span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">#pragma mark 设置默认显示图片</span></span><br><span class="line">-(<span class="keyword">void</span>)setDefaultImage&#123;</span><br><span class="line">    <span class="comment">//加载默认图片</span></span><br><span class="line">    _leftImageView.image=[<span class="built_in">UIImage</span> imageNamed:[<span class="built_in">NSString</span> stringWithFormat:<span class="string">@"%i.jpg"</span>,_imageCount<span class="number">-1</span>]];</span><br><span class="line">    _centerImageView.image=[<span class="built_in">UIImage</span> imageNamed:[<span class="built_in">NSString</span> stringWithFormat:<span class="string">@"%i.jpg"</span>,<span class="number">0</span>]];</span><br><span class="line">    _rightImageView.image=[<span class="built_in">UIImage</span> imageNamed:[<span class="built_in">NSString</span> stringWithFormat:<span class="string">@"%i.jpg"</span>,<span class="number">1</span>]];</span><br><span class="line">    _currentImageIndex=<span class="number">0</span>;</span><br><span class="line">    <span class="comment">//设置当前页</span></span><br><span class="line">    _pageControl.currentPage=_currentImageIndex;</span><br><span class="line">    <span class="built_in">NSString</span> *imageName=[<span class="built_in">NSString</span> stringWithFormat:<span class="string">@"%i.jpg"</span>,_currentImageIndex];</span><br><span class="line">    _label.text=_imageData[imageName];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">#pragma mark 添加分页控件</span></span><br><span class="line">-(<span class="keyword">void</span>)addPageControl&#123;</span><br><span class="line">    _pageControl=[[<span class="built_in">UIPageControl</span> alloc]init];</span><br><span class="line">    <span class="comment">//注意此方法可以根据页数返回UIPageControl合适的大小</span></span><br><span class="line">    <span class="built_in">CGSize</span> size= [_pageControl sizeForNumberOfPages:_imageCount];</span><br><span class="line">    _pageControl.bounds=<span class="built_in">CGRectMake</span>(<span class="number">0</span>, <span class="number">0</span>, size.width, size.height);</span><br><span class="line">    _pageControl.center=<span class="built_in">CGPointMake</span>(SCREEN_WIDTH/<span class="number">2</span>, SCREEN_HEIGHT<span class="number">-100</span>);</span><br><span class="line">    <span class="comment">//设置颜色</span></span><br><span class="line">    _pageControl.pageIndicatorTintColor=[<span class="built_in">UIColor</span> colorWithRed:<span class="number">193</span>/<span class="number">255.0</span> green:<span class="number">219</span>/<span class="number">255.0</span> blue:<span class="number">249</span>/<span class="number">255.0</span> alpha:<span class="number">1</span>];</span><br><span class="line">    <span class="comment">//设置当前页颜色</span></span><br><span class="line">    _pageControl.currentPageIndicatorTintColor=[<span class="built_in">UIColor</span> colorWithRed:<span class="number">0</span> green:<span class="number">150</span>/<span class="number">255.0</span> blue:<span class="number">1</span> alpha:<span class="number">1</span>];</span><br><span class="line">    <span class="comment">//设置总页数</span></span><br><span class="line">    _pageControl.numberOfPages=_imageCount;</span><br><span class="line">    </span><br><span class="line">    [<span class="keyword">self</span>.view addSubview:_pageControl];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">#pragma mark 添加信息描述控件</span></span><br><span class="line">-(<span class="keyword">void</span>)addLabel&#123;</span><br><span class="line">    </span><br><span class="line">    _label=[[<span class="built_in">UILabel</span> alloc]initWithFrame:<span class="built_in">CGRectMake</span>(<span class="number">0</span>, <span class="number">10</span>, SCREEN_WIDTH,<span class="number">30</span>)];</span><br><span class="line">    _label.textAlignment=<span class="built_in">NSTextAlignmentCenter</span>;</span><br><span class="line">    _label.textColor=[<span class="built_in">UIColor</span> colorWithRed:<span class="number">0</span> green:<span class="number">150</span>/<span class="number">255.0</span> blue:<span class="number">1</span> alpha:<span class="number">1</span>];</span><br><span class="line">    </span><br><span class="line">    [<span class="keyword">self</span>.view addSubview:_label];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">#pragma mark 滚动停止事件</span></span><br><span class="line">-(<span class="keyword">void</span>)scrollViewDidEndDecelerating:(<span class="built_in">UIScrollView</span> *)scrollView&#123;</span><br><span class="line">    <span class="comment">//重新加载图片</span></span><br><span class="line">    [<span class="keyword">self</span> reloadImage];</span><br><span class="line">    <span class="comment">//移动到中间</span></span><br><span class="line">    [_scrollView setContentOffset:<span class="built_in">CGPointMake</span>(SCREEN_WIDTH, <span class="number">0</span>) animated:<span class="literal">NO</span>];</span><br><span class="line">    <span class="comment">//设置分页</span></span><br><span class="line">    _pageControl.currentPage=_currentImageIndex;</span><br><span class="line">    <span class="comment">//设置描述</span></span><br><span class="line">    <span class="built_in">NSString</span> *imageName=[<span class="built_in">NSString</span> stringWithFormat:<span class="string">@"%i.jpg"</span>,_currentImageIndex];</span><br><span class="line">    _label.text=_imageData[imageName];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">#pragma mark 重新加载图片</span></span><br><span class="line">-(<span class="keyword">void</span>)reloadImage&#123;</span><br><span class="line">    <span class="keyword">int</span> leftImageIndex,rightImageIndex;</span><br><span class="line">    <span class="built_in">CGPoint</span> offset=[_scrollView contentOffset];</span><br><span class="line">    <span class="keyword">if</span> (offset.x&gt;SCREEN_WIDTH) &#123; <span class="comment">//向右滑动</span></span><br><span class="line">        _currentImageIndex=(_currentImageIndex+<span class="number">1</span>)%_imageCount;</span><br><span class="line">    &#125;<span class="keyword">else</span> <span class="keyword">if</span>(offset.x&lt;SCREEN_WIDTH)&#123; <span class="comment">//向左滑动</span></span><br><span class="line">        _currentImageIndex=(_currentImageIndex+_imageCount<span class="number">-1</span>)%_imageCount;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//UIImageView *centerImageView=(UIImageView *)[_scrollView viewWithTag:2];</span></span><br><span class="line">    _centerImageView.image=[<span class="built_in">UIImage</span> imageNamed:[<span class="built_in">NSString</span> stringWithFormat:<span class="string">@"%i.jpg"</span>,_currentImageIndex]];</span><br><span class="line">    </span><br><span class="line">    <span class="comment">//重新设置左右图片</span></span><br><span class="line">    leftImageIndex=(_currentImageIndex+_imageCount<span class="number">-1</span>)%_imageCount;</span><br><span class="line">    rightImageIndex=(_currentImageIndex+<span class="number">1</span>)%_imageCount;</span><br><span class="line">    _leftImageView.image=[<span class="built_in">UIImage</span> imageNamed:[<span class="built_in">NSString</span> stringWithFormat:<span class="string">@"%i.jpg"</span>,leftImageIndex]];</span><br><span class="line">    _rightImageView.image=[<span class="built_in">UIImage</span> imageNamed:[<span class="built_in">NSString</span> stringWithFormat:<span class="string">@"%i.jpg"</span>,rightImageIndex]];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">@end</span></span><br></pre></td></tr></table></figure>
<p>​</p>
</li>
</ul>
]]></content>
      
        <categories>
            
            <category> iOS开发 </category>
            
        </categories>
        
        
        <tags>
            
            <tag> iOS </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[UIView解析]]></title>
      <url>/2018/01/27/UIView%E8%A7%A3%E6%9E%90/</url>
      <content type="html"><![CDATA[<p>UIView是管理屏幕上矩形区域内容的对象，iOS中几乎所有UI控件都是UIView的子类。</p>
<p><img src="/2018/01/27/UIView解析/1.png" alt="UIView"></p>
<h4 id="三个结构体CGPoint、CGSize、CGRect"><a href="#三个结构体CGPoint、CGSize、CGRect" class="headerlink" title="三个结构体CGPoint、CGSize、CGRect"></a>三个结构体CGPoint、CGSize、CGRect</h4><ul>
<li><p>1.CGPoint</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">struct</span> <span class="built_in">CGPoint</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="built_in">CGFloat</span> x; <span class="comment">//控件x轴位置</span></span><br><span class="line">  <span class="built_in">CGFLoat</span> y; <span class="comment">//控件Y轴位置</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
</ul>
<ul>
<li><p>CGSize</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">struct</span> <span class="built_in">CGSize</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="built_in">CGFloat</span> width; <span class="comment">//控件宽度</span></span><br><span class="line">  <span class="built_in">CGFloat</span> height; <span class="comment">//控件高度</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>CGRect</li>
</ul>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">struct</span> <span class="built_in">CGRect</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="built_in">CGPoint</span> origin; <span class="comment">//偏移量是相对父视图的</span></span><br><span class="line">  <span class="built_in">CGSize</span> size;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="视图的基本属性"><a href="#视图的基本属性" class="headerlink" title="视图的基本属性"></a>视图的基本属性</h4><p>​</p>
<ul>
<li><p>frame和center都是相对父视图来说的，bounds是相对自身来说的</p>
</li>
<li><p>frame是相对于父视图左上角原点(0,0)的位置，改变视图的frame会改变center中心点</p>
</li>
<li><p>center是CGPoint值的就是整个视图的中心点，改变视图的center也会改变frame</p>
</li>
<li><p>bounds 是CGRect  是告诉子视图本视图的原点位置(通俗的说就是，子视图的frame的origin与父视图的bounds的origin的差，就是子视图相对于父视图左上角的位置，如果结果为负，则子视图在父视图外)</p>
</li>
<li><p>通过addSubview方法添加的子视图，越后添加，越显示到上层。</p>
</li>
<li><p>移除父视图也会把它里面的子视图移除</p>
</li>
</ul>
<h4 id="基本界面元素"><a href="#基本界面元素" class="headerlink" title="基本界面元素"></a>基本界面元素</h4><ul>
<li><p>1.UIView</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">UIView</span> *myView = [[<span class="built_in">UIView</span> alloc]initWithFrame:<span class="built_in">CGrectMake</span>(<span class="number">10</span>,<span class="number">10</span>,<span class="number">50</span>,<span class="number">50</span>)];<span class="comment">//创建了一个x轴10，y轴10，宽度为50，高度为50的UIView.</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>2.UIWindow</p>
<ul>
<li><p>UIWindow继承自UIView，在系统的初始化过程中创建(application didFinishLauchingWithOptions里面)</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">self</span>.window = [[[<span class="built_in">UIWindos</span> alloc]initWithFrame:[<span class="built_in">UIScreen</span> mainScreen]bounds]autorelease];</span><br><span class="line"><span class="keyword">self</span>.window.backgroundColor = [<span class="built_in">UIColor</span> grayColor];       <span class="comment">//给window设置一个背景色  </span></span><br><span class="line">[<span class="keyword">self</span>.window makeKeyAndVisible];     <span class="comment">//让window显示出来</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>UIScreen代表了屏幕</p>
</li>
</ul>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">CGRect</span> screenBounds = [ [<span class="built_in">UIScreen</span> mainScreen]bounds];    <span class="comment">//返回的是带有状态栏的Rect </span></span><br><span class="line"><span class="built_in">CGRect</span> viewBounds = [ [<span class="built_in">UIScreen</span> mainScreen]applicationFrame];    <span class="comment">//不包含状态栏的Rect</span></span><br></pre></td></tr></table></figure>
<p>​</p>
</li>
</ul>
<h4 id="UIView的方法"><a href="#UIView的方法" class="headerlink" title="UIView的方法"></a>UIView的方法</h4><ul>
<li>一个 UIView 里面可以包含许多的 Subview（其他的 UIView），而这些 Subview 彼此之间是有所谓的阶层关系，这有点类似绘图软体中图层的概念，下面程式码示演示了几个在管理图层（Subview）上常用的方法，其程式码如下。</li>
<li><p>1.首先是大家最常使用的新增和移除Subview。</p>
<p>​<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[Subview removeFromSuperview];     <span class="comment">//将Subview从当前的UIView中移除 </span></span><br><span class="line">[<span class="built_in">UIView</span> addSubview:Subview];     <span class="comment">//UIView增加一个Subview</span></span><br><span class="line">​</span><br></pre></td></tr></table></figure></p>
</li>
<li><p>2.在UIView中将Subview往前或是往后移动一个图层，往前移动会覆盖住较后层的 Subview，而往后移动则会被较上层的Subview所覆盖。</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[<span class="built_in">UIView</span> bringSubviewToFront:Subview];       <span class="comment">//将Subview往前移动一个图层（与它的前一个图层对调位置）//将Subview往前移动一个图层（与它的前一个图层对调位置）</span></span><br><span class="line"></span><br><span class="line">[<span class="built_in">UIView</span> sendSubviewToBack:Subview];      <span class="comment">//将Subview往后移动一个图层（与它的后一个图层对调位置)</span></span><br></pre></td></tr></table></figure>
</li>
</ul>
<ul>
<li><p>3.在UIView中使用索引Index交换两的Subview彼此的图层层级。</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[<span class="built_in">UIView</span> exchangeSubviewAtIndex:indexA withSubviewAtIndex:indexB];    <span class="comment">//交换两个图层</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>4.使用Subview的变数名称取得它在UIView中的索引值（Index ）</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">NSInteger</span> index = [[<span class="built_in">UIView</span> subviews] indexOfObject:Subview名称];       <span class="comment">//取得Index</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>5.替Subview加上NSInteger 的註记(Tag)好让之后它们分辨彼此。</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[Subview setTag:<span class="built_in">NSInteger</span>];       <span class="comment">//加上标记</span></span><br><span class="line">	[<span class="built_in">UIView</span> viewWithTag:<span class="built_in">NSInteger</span>];  <span class="comment">//通过标记得到view 返回值为UIView</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>6.最后是取得UIView中所有的Subview，呼叫此方法会传回一个 NSArray，并以由后往前的顺序列出这些 Subview，下图中是列出范例图片里Root中所有的Subview。</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[<span class="built_in">UIView</span> subviews] ;        <span class="comment">//取的UIView下的所有Subview</span></span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
</ul>
<h4 id="UIView常用属性和方法"><a href="#UIView常用属性和方法" class="headerlink" title="UIView常用属性和方法"></a>UIView常用属性和方法</h4><ul>
<li>属性</li>
</ul>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">@property</span>(<span class="keyword">nonatomic</span>) <span class="built_in">CGRect</span> frame;<span class="comment">//控件的位置和大小，所有的控件必须指定这个属性，否则即使有控件也无法显示</span></span><br><span class="line"><span class="keyword">@property</span>(<span class="keyword">nonatomic</span>) <span class="built_in">CGRect</span> bounds;<span class="comment">//当前控件位置和大小，但是和frame不同的是它的位置是确定的(0,0)</span></span><br><span class="line"><span class="keyword">@property</span>(<span class="keyword">nonatomic</span>) <span class="built_in">CGPoint</span> center;<span class="comment">//控件的中心位置，一般用户进行控件定位</span></span><br><span class="line"><span class="keyword">@property</span>(<span class="keyword">nonatomic</span>) <span class="built_in">CGAffineTransform</span> transform;<span class="comment">//控件矩阵变化，包括平移、缩放、旋转，默认为CGAffineTransformIdentity</span></span><br><span class="line"><span class="keyword">@property</span>(<span class="keyword">nonatomic</span>) <span class="built_in">UIViewAutoresizing</span> autoresizingMask;<span class="comment">//控件旋转时大小自动伸缩，默认为UIViewAutoresizingNone</span></span><br><span class="line"><span class="keyword">@property</span>(<span class="keyword">nonatomic</span>,<span class="keyword">readonly</span>) <span class="built_in">UIView</span> *superview;<span class="comment">//当前控件的父控件</span></span><br><span class="line"><span class="keyword">@property</span>(<span class="keyword">nonatomic</span>,<span class="keyword">readonly</span>,<span class="keyword">copy</span>) <span class="built_in">NSArray</span> *subviews;<span class="comment">//当前控件的子控件返回一个数组</span></span><br><span class="line"><span class="keyword">@property</span>(<span class="keyword">nonatomic</span>,<span class="keyword">getter</span>=isHidden) <span class="built_in">BOOL</span> hidden;<span class="comment">//是否隐藏，默认为不隐藏。</span></span><br><span class="line"><span class="keyword">@property</span>(<span class="keyword">nonatomic</span>) <span class="built_in">UIViewContentMode</span> contentMode; <span class="comment">//控件的显示模式。如ImageView的居中模式等</span></span><br><span class="line"><span class="keyword">@property</span>(<span class="keyword">nonatomic</span>) <span class="built_in">NSInteger</span> tag;<span class="comment">//控件的标签属性</span></span><br></pre></td></tr></table></figure>
<ul>
<li><p>方法</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">- (<span class="keyword">void</span>)addSubview:(<span class="built_in">UIView</span> *) view;<span class="comment">//添加子控件</span></span><br><span class="line">- (<span class="keyword">void</span>)removeFromSuperView;<span class="comment">//从父控件中移除当前控件</span></span><br><span class="line">- (<span class="keyword">void</span>)insertSubview:(<span class="built_in">UIView</span> *)view atIndex:(<span class="built_in">NSInteger</span>) index; <span class="comment">//在指定位置插入子控件</span></span><br><span class="line">- (<span class="keyword">void</span>)beginAnimations:*(<span class="built_in">NSString</span> *)animationID context:(<span class="keyword">void</span> *)context;<span class="comment">//开始一段动画</span></span><br><span class="line">+ (<span class="keyword">void</span>)animateWithDuration:(<span class="built_in">NSTimeInterval</span>)duration animations:(<span class="keyword">void</span> (^)(<span class="keyword">void</span>))animations <span class="built_in">NS_AVAILABLE_IOS</span>(<span class="number">4</span>_0);<span class="comment">//以block的形式执行一段动画，注意这个方法有几种相关的方法</span></span><br><span class="line">- (<span class="keyword">void</span>)addGestureRecognizer:(<span class="built_in">UIGestureRecognizer</span>*)gestureRecognizer <span class="built_in">NS_AVAILABLE_IOS</span>(<span class="number">3</span>_2);	<span class="comment">//添加手势操作</span></span><br><span class="line">- (<span class="keyword">void</span>)removeGestureRecognizer:(<span class="built_in">UIGestureRecognizer</span>*)gestureRecognizer <span class="built_in">NS_AVAILABLE_IOS</span>(<span class="number">3</span>_2); <span class="comment">//移除手势操作</span></span><br></pre></td></tr></table></figure>
<p><code>上面所有位置的属性都是相对于父控件而言（不是相对主屏幕而言）</code></p>
<p>​</p>
</li>
</ul>
]]></content>
      
        <categories>
            
            <category> iOS开发 </category>
            
        </categories>
        
        
        <tags>
            
            <tag> iOS </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[iOS程序启动过程]]></title>
      <url>/2018/01/26/iOS%E7%A8%8B%E5%BA%8F%E5%90%AF%E5%8A%A8%E8%BF%87%E7%A8%8B/</url>
      <content type="html"><![CDATA[<ul>
<li>点击程序图标打开程序</li>
<li>执行main函数</li>
<li>执行UIApplicationMain函数</li>
<li><p>通过UIApplicationMain方法的反射创建UIApplication对象设置代理，开启消息循环</p>
<ul>
<li><p>开启监听程序事件</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">- (<span class="built_in">BOOL</span>)application:(<span class="built_in">UIApplication</span> *)application didFinishLaunchingWithOptions:(<span class="built_in">NSDictionary</span> *)launchOptions &#123;<span class="comment">//程序加载完毕后调用该方法&#125;</span></span><br><span class="line">- (<span class="keyword">void</span>)applicationWillResignActive:(<span class="built_in">UIApplication</span> *)application &#123;<span class="comment">//程序失去焦点调用该方法&#125;</span></span><br><span class="line">- (<span class="keyword">void</span>)applicationDidEnterBackground:(<span class="built_in">UIApplication</span> *)application &#123;<span class="comment">//程序进入后台调用该方法&#125;</span></span><br><span class="line">- (<span class="keyword">void</span>)applicationWillEnterForeground:(<span class="built_in">UIApplication</span> *)application &#123;<span class="comment">//程序从后台将要进入前台调用该方法&#125;</span></span><br><span class="line">- (<span class="keyword">void</span>)applicationDidBecomeActive:(<span class="built_in">UIApplication</span> *)application &#123;<span class="comment">//内存经过，程序将要停止调用该方法&#125;</span></span><br><span class="line">- (<span class="keyword">void</span>)applicationWillTerminate:(<span class="built_in">UIApplication</span> *)application &#123;<span class="comment">//程序将要退出调用该方法&#125;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>加载info.plist程序配置文件，主要是看我们用的是Storyboard方式加载还是代码的方式加载。</p>
<ul>
<li><p>通过storyboard方式加载</p>
<ul>
<li><p>在程序启动完成的时候系统自动创建一个UIWindow的实例来显示界面</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">@property</span> (<span class="keyword">strong</span>, <span class="keyword">nonatomic</span>) <span class="built_in">UIWindow</span> *window;</span><br></pre></td></tr></table></figure>
</li>
<li><p>设置窗口的根控制器</p>
<ul>
<li>根据storyboard的设置，创建一个控制器。</li>
<li>并且设置这个控制器为之前创建的UIWindow的根控制器</li>
</ul>
</li>
<li>显示窗口。（makeKeyAndVisible）<ul>
<li>设置self.window可见并且设置UIApplication的keyWindow</li>
</ul>
</li>
</ul>
</li>
<li><p>通过代码加载</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">- (<span class="built_in">BOOL</span>)application:(<span class="built_in">UIApplication</span> *)application didFinishLaunchingWithOptions:(<span class="built_in">NSDictionary</span> *)launchOptions &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">self</span>.window = [[<span class="built_in">UIWindow</span> alloc] initWithFrame:[<span class="built_in">UIScreen</span> mainScreen].bounds];</span><br><span class="line">    <span class="built_in">UIViewController</span> *viewController = [[<span class="built_in">UIViewController</span> alloc] init];</span><br><span class="line">    <span class="keyword">self</span>.window.rootViewController = viewController;</span><br><span class="line">    [<span class="keyword">self</span>.window makeKeyAndVisible];</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">YES</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>​</p>
<ul>
<li>首先创建串口，获取到一个UIWindow实例来显示界面。（self.window为系统自带）</li>
<li>创建一个控制器，将该控制器设置为根控制器</li>
<li>显示窗口<code>[self.window makeKeyAndVisible]</code></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li><p>结束程序</p>
</li>
</ul>
]]></content>
      
        <categories>
            
            <category> iOS开发 </category>
            
        </categories>
        
        
        <tags>
            
            <tag> iOS </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[Mac系统搭建基于GitHhub的Hexo博客]]></title>
      <url>/2018/01/23/Mac%E4%B8%8A%E6%90%AD%E5%BB%BA%E5%9F%BA%E4%BA%8EGitHhub%E7%9A%84Hexo%E5%8D%9A%E5%AE%A2/</url>
      <content type="html"><![CDATA[<h3 id="1-注册GitHub帐号"><a href="#1-注册GitHub帐号" class="headerlink" title="1. 注册GitHub帐号"></a>1. 注册GitHub帐号</h3><ul>
<li>进入<a href="https://github.com/" target="_blank" rel="noopener">GitHub官网</a>注册帐号</li>
<li>创建一个仓库，名称为 yourname.github.io 其中yourname是你的github名称,按照这个规则创建才有用。如你的github注册名称为jack那你创建的仓库名称为jack.github.io</li>
</ul>
<h3 id="2-安装node-js"><a href="#2-安装node-js" class="headerlink" title="2. 安装node.js"></a>2. 安装node.js</h3><ul>
<li>进入<a href="https://nodejs.org/en/" target="_blank" rel="noopener">nodejs官网</a>下载一步步安装即可,建议安装通用版。</li>
<li>安装完成后可以在终端测试 Node.js 和npm 是否可以使用了。</li>
<li>查看 Node.js 的版本号在终端里输入如下命令：<code>node -v</code> 如果Node.js 成功安装，可以看到类似如下的信息：v6.5.0。查看npm 的版本号在终端里输入如下命令：<code>npm -v</code>如果npm 成功安装，可以看到类似如下的信息：3.10.3。注意命令中间有空格。</li>
</ul>
<h3 id="3-安装hexo"><a href="#3-安装hexo" class="headerlink" title="3. 安装hexo"></a>3. 安装hexo</h3><ul>
<li>可以查看<a href="https://hexo.io/zh-cn/docs/" target="_blank" rel="noopener">Hexo中文文档</a></li>
<li>在终端输入 <code>npm install -g hexo-cli</code> 安装</li>
<li>如果Mac系统在安装过程中报错需要安装命令行工具</li>
<li>在终端中输入命令 <code>xcode-select --install</code>会弹出一个窗口选择安装即可。安装完成后输入命令 <code>gcc-v</code>会看到如下信息 <code>Configured with: --prefix=/Applications/Xcode.app/Contents/Developer/usr --with-gxx-include-dir=/usr/include/c++/4.2.1
Apple LLVM version 8.0.0 (clang-800.0.38)
Target: x86_64-apple-darwin15.5.0
Thread model: posix
InstalledDir: /Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/bin</code>说明安装完成</li>
<li>安装完命令行工具后再输入 $ npm install -g hexo-cli 来安装Hexo，安装完成后输入 <code>hexo</code> 命令会出现下图<br>  <img src="/2018/01/23/Mac上搭建基于GitHhub的Hexo博客/Hexo安装完成图.png" alt="Hexo安装完成图"></li>
</ul>
<h3 id="4-初始化博客"><a href="#4-初始化博客" class="headerlink" title="4. 初始化博客"></a>4. 初始化博客</h3><ul>
<li>新建一个文件夹如我是在文档下新建了一个名称为blog的文件夹名字可以随便取在终端cd到该文件夹 <code>cd Documents/blog/</code> 然后运行 <code>hexo init</code>命令行，速度取决于网速，可能需要几分钟完成，成功后会在blog目录下生成相关文件，如图<br> <img src="/2018/01/23/Mac上搭建基于GitHhub的Hexo博客/blog相关文件目录.png" alt="初始化后生成的文件目录结构"></li>
<li>安装完成后运行 <code>hexo s</code> 现在即可在浏览器本地访问 <code>http://localhost:4000/</code> 会出现下图证明安装成功<br>  <img src="/2018/01/23/Mac上搭建基于GitHhub的Hexo博客/hexo.png" alt="初始化后生成的文件目录结构"></li>
</ul>
<h3 id="5-关联GitHub"><a href="#5-关联GitHub" class="headerlink" title="5. 关联GitHub"></a>5. 关联GitHub</h3><ul>
<li>终端 <code>open Documents/blog/</code> 打开刚才新建的blog文件夹就是我们把hexo init的那个文件夹。打开文件夹下 <code>_config.yml</code>文件,建议使用Sublime Text打开其他文本编辑器也行，滑到最下面修改成如下样子,将我的名字改成你的名字。<br>  <img src="/2018/01/23/Mac上搭建基于GitHhub的Hexo博客/关联github.png" alt="初始化后生成的文件目录结构"><br>  <code>注意：在配置所有的_config.yml文件时（包括theme中的）在所有的冒号:后边都要加一个空格，否则执行hexo命令会报错</code></li>
<li>在blog文件夹目录下执行生成静态页面命令：<code>hexo g</code> 然后执行<code>hexo d</code><br>执行hexo d部署需要你的github用户名和密码</li>
</ul>
<h3 id="6-发布文章"><a href="#6-发布文章" class="headerlink" title="6. 发布文章"></a>6. 发布文章</h3><ul>
<li>终端cd到blog文件夹下运行 <code>hexo new “firstName”</code>名为firstName.md的文件会建在目录/blog/source/_posts下，firstName是文件名.建议使用Mou编辑器。如下图，新建title：为文章名称，date：创建时间，tags:文章所属标签，categories：文章所属分类，注意刚开始新建的文章打开是没有分类的需要修改新建文章模版，打开目录下scaffolds文件夹下的post.md文件在标签上面添加 <code>categories:</code>后续新建文章就会添加分类栏目。<br>  <img src="/2018/01/23/Mac上搭建基于GitHhub的Hexo博客/新建文章.png" alt="新建文章"><br>  如下图是这篇文章的属性，分类和标签可修改成任意名称，Hexo会自动根据标签和分类归纳文章。<br>  <img src="/2018/01/23/Mac上搭建基于GitHhub的Hexo博客/文章属性.png" alt="文章属性"></li>
</ul>
]]></content>
      
        <categories>
            
            <category> 技术杂记 </category>
            
        </categories>
        
        
    </entry>
    
    <entry>
      <title><![CDATA[惯例]]></title>
      <url>/2018/01/18/index/</url>
      <content type="html"><![CDATA[<p>hello world</p>
]]></content>
      
        
    </entry>
    
  
  
</search>
